panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# Remove labels from the vertical axis
axis.text.y = element_blank(),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Arial", size = 12)) +
geom_text(aes(x = perc, y = consv_topic, label = consv_topic),
hjust = 0,
nudge_x = 0.3,
colour = "dodgerblue4",
family = "Arial",
size = 3.5)+
labs(subtitle = "Percent of sum from all articles (%)") +
theme(plot.subtitle = element_text(
family = "Arial",
size = 13)
)
consv_bar
View(consv_s)
ggsave("figures/ms_figs/consv_perc/consv_bar.pdf", height = 5, width = 5, units = c("in"))
ggsave("figures/ms_figs/consv_perc/consv_bar.pdf", consv_bar, height = 5, width = 5, units = c("in"))
consv_bar <- ggplot(consv_s) +
geom_bar(aes(x = perc, y = reorder(consv_topic, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
expand = c(0,0),
limits = c(0, 45))+
scale_y_discrete(expand = expansion(add = c(0,0))) +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# Remove labels from the vertical axis
axis.text.y = element_blank(),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Arial", size = 12)) +
geom_text(aes(x = perc, y = consv_topic, label = consv_topic),
hjust = 0,
nudge_x = 0.3,
colour = "dodgerblue4",
#family = "Arial",
size = 3.5)+
labs(subtitle = "Percent of sum from all articles (%)") +
theme(plot.subtitle = element_text(
#family = "Arial",
size = 13)
)
consv_bar
ggsave("figures/ms_figs/consv_perc/consv_bar.pdf", consv_bar, height = 5, width = 5, units = c("in"))
consv_bar2 <- ggplot(consv_s) +
geom_bar(aes(x = perc, y = reorder(consv_bin, perc), fill = consv_topic), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
expand = c(0,0),
limits = c(0, 45))+
scale_y_discrete(expand = expansion(add = c(0,0))) +
theme(
panel.background = element_rect(fill = "white"),
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
axis.ticks.length = unit(0, "mm"),
axis.title = element_blank(),
axis.line.y.left = element_line(color = "black"),
axis.text.y = element_blank(),
axis.text.x = element_text(family = "Arial", size = 12)) +
geom_text(aes(x = perc, y = consv_bin, label = consv_bin),
hjust = 0,
nudge_x = 0.3,
colour = "dodgerblue4",
#family = "Arial",
size = 3.5)+
labs(subtitle = "Percent of sum from all articles (%)") +
theme(plot.subtitle = element_text(
f#amily = "Arial",
size = 13)
consv_bar2
consv_bar2 <- ggplot(consv_s) +
geom_bar(aes(x = perc, y = reorder(consv_bin, perc), fill = consv_topic), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
expand = c(0,0),
limits = c(0, 45))+
scale_y_discrete(expand = expansion(add = c(0,0))) +
theme(
panel.background = element_rect(fill = "white"),
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
axis.ticks.length = unit(0, "mm"),
axis.title = element_blank(),
axis.line.y.left = element_line(color = "black"),
axis.text.y = element_blank(),
axis.text.x = element_text(family = "Arial", size = 12)) +
geom_text(aes(x = perc, y = consv_bin, label = consv_bin),
hjust = 0,
nudge_x = 0.3,
colour = "dodgerblue4",
#family = "Arial",
size = 3.5)+
labs(subtitle = "Percent of sum from all articles (%)") +
theme(plot.subtitle = element_text(
#family = "Arial",
size = 13)
)
consv_bar2
consv_bar <- ggplot(consv_s) +
geom_bar(aes(x = perc, y = reorder(consv_topic, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
expand = c(0,0),
limits = c(0, 45))+
scale_y_discrete(expand = expansion(add = c(0,0))) +
theme(
panel.background = element_rect(fill = "white"),
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
axis.ticks.length = unit(0, "mm"),
axis.title = element_blank(),
axis.line.y.left = element_line(color = "black"),
axis.text.y = element_blank(),
axis.text.x = element_text(family = "Arial", size = 12)) +
geom_text(aes(x = perc, y = consv_topic, label = consv_topic),
hjust = 0,
nudge_x = 0.3,
colour = "dodgerblue4",
#family = "Arial",
size = 3.5)+
labs(subtitle = "Percent of sum from all articles (%)") +
theme(plot.subtitle = element_text(
#family = "Arial",
size = 13)
)
consv_bar
ggsave("figures/ms_figs/consv_perc/consv_bar.pdf", consv_bar, height = 5, width = 5, units = c("in"))
#literature
code_rel_melt <- reshape::melt(code_rel2)
code_rel_melt$variable <- gsub(".", " ", code_rel_melt$variable, fixed = TRUE)
code_rel_melt <- code_rel_melt %>%
separate(Code.System, c("key", "code1"), "> ", convert = TRUE)
code_rel_melt$key <- str_trim(code_rel_melt$key)
colnames(code_rel_melt) <- c("brba_code1", "code1", "code2", "total")
#add brba column to second code col
code_rel_melt2 <- code_rel_melt
code_rel_melt2$code2[code_rel_melt2$code2 == "Fine scale management appropriate for target species"] <- "Fine-scale management appropriate for target species"
code_rel_melt2$code2[code_rel_melt2$code2 == "Pre existing regulation and management institutions"] <- "Pre-existing regulation and management institutions"
code_rel_melt2$code2[code_rel_melt2$code2 == "Co management and communication"] <- "Co-management and communication"
code_rel_melt_h <- code_rel_melt2 %>%
#filter(total >= 11) %>%
mutate(#bor_box = ifelse(total >= 11, "TRUE", "FALSE"),
#bor_box = as.factor(bor_box),
code1 = as.factor(code1),
code2 = as.factor(code2))
code_rel_melt_h$code1 <- factor(code_rel_melt_h$code1, levels = c(as.character(unique(code_rel_melt_h$code1))))
code_rel_melt_h$code2 <- factor(code_rel_melt_h$code2, levels =
c("Need for multispecies management",	"Implementation costs",	"Indirect socioeconomic consequences",	"Discontinuity",	"Poor communication and outreach",	"Poor program implementation", "Model abuse", "Gaps and inaccuracy", "Climate change adding uncertainty to target species habitat use",	"Management scales do not align with system needs"))
#format data
freq_job_survey <- code_vars_s %>%
select(c(1, 21:54)) %>%
janitor::clean_names() %>%
pivot_longer(2:35, names_to = "sub_theme", values_to = "total") %>%
group_by(survey, sub_theme) %>%
summarise(total = sum(total),
.groups = "drop") %>%
mutate(fish_ship = ifelse(str_detect(survey, "WhaleWatch"), "Shipping", "Fishing"))
lib_job_survey <- code_freq_s %>%
mutate(id = paste(bridge_barr, code_cat, code_name, sep = "_")) %>%
select(id)
freq_job_survey$id <- NA
for(i in 1:nrow(freq_job_survey)){
curr_code = freq_job_survey$sub_theme[i]
curr_id = lib_job_survey$id[agrepl(curr_code, lib_job_survey$id, 6)]
freq_job_survey$id[i] <- curr_id
}
freq_job_survey$id[freq_job_survey$sub_theme == "stigmatization"] <- "Barrier_Social barrier_Stigmatization"
freq_job_survey$id[freq_job_survey$sub_theme == "cost"] <- "Barrier_Social barrier_Cost"
freq_job_survey <- freq_job_survey %>%
separate_wider_delim(id, delim = "_", names = c("bridge_barr", "code_cat", "code_name"))
freq_job_survey$bridge_barr <- factor(freq_job_survey$bridge_barr, levels = c("Bridge", "Barrier"))
#calculate proportions
freq_job_survey2 <- freq_job_survey %>%
group_by(fish_ship, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(fish_ship, bridge_barr, code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(code_level = if_else(code_cat %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(code_cat %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(code_cat %in% c("Social barrier", "Social bridge"), "Social bridge or barrier",
if_else(code_cat %in% c("Implementation bridge", "Implementation barrier"), "Implementation bridge or barrier", NA)))),
id = paste(fish_ship, bridge_barr, code_cat)) %>%
distinct(id, .keep_all = TRUE)
View(freq_job_survey2)
#stacked bar plots
ggplot(freq_job_survey2, aes(fill=code_level, y=value, x=fish_ship)) +
geom_bar(position="stack", stat="identity") +
scale_fill_manual(values = c("#CFE2F3", "#C5E0B4","royalblue4","#45818E")) +
facet_wrap(~bridge_barr) +
labs(fill = "") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))+
theme_ms() +
theme(legend.position = "top",
legend.justification = "left",
legend.text = element_text(size = 14, color = "black"))+
xlab("") +
ylab("Proportion of theme (%)")
freq_job_survey2 %>% group_by(code_cat) %>% summarise(total = sum(value))
freq_job_survey2 %>%
mutate(all_codes = sum(value)) %>%
group_by(code_cat) %>%
summarise(prop = value/all_codes)
freq_job_survey2 %>% group_by(fish_ship, code_cat) %>% summarise(value = value)
#radar plots
freq_job_survey3 <- freq_job_survey %>%
# group_by(fish_ship, bridge_barr) %>%
# mutate(n_total = sum(total)) %>%
# ungroup() %>%
# group_by(fish_ship, bridge_barr, code_name) %>%
# mutate(n_subtotal = sum(total)) %>%
# reframe(value = (n_subtotal/n_total)*100) %>%
# ungroup() %>%
#mutate(id = paste(fish_ship, bridge_barr, code_name)) %>%
#distinct(id, .keep_all = TRUE) %>%
#select(-c(id))
group_by(fish_ship, bridge_barr, code_name) %>%
summarise(value = sum(total))
View(freq_job_survey3)
#format data
freq_job_lit <- code_vars %>%
select(c(1, 27:29, 33:60)) %>%
janitor::clean_names() %>%
pivot_longer(2:4, names_to = "test", values_to = "fish_ship") %>%
select(-c(test)) %>%
pivot_longer(2:29, names_to = "sub_theme", values_to = "total") %>%
group_by(fish_ship, sub_theme) %>%
summarise(total = sum(total),
.groups = "drop") %>%
filter(fish_ship == "Bycatch" | fish_ship == "Ship strikes" | fish_ship == "Overfishing" | fish_ship == "Entanglement" | fish_ship == "Avoid fisheries discharge")
lib_job_lit <- code_freq %>%
mutate(id = paste(bridge_barr, code_cat, code_name, sep = "_")) %>%
select(id)
freq_job_lit$id <- NA
for(i in 1:nrow(freq_job_lit)){
curr_code = freq_job_lit$sub_theme[i]
curr_id = lib_job_lit$id[agrepl(curr_code, lib_job_lit$id, 10)] #6 refers to the number of characters that can be diff
freq_job_lit$id[i] <- curr_id
}
freq_job_lit$id[freq_job_lit$sub_theme == "abiotic_data_availability"] <- "Bridge_Data bridge_Abiotic data availability"
freq_job_lit$id[freq_job_lit$sub_theme == "abiotic_indicators_of_target_species_presence"] <-
"Bridge_Ecological bridge_Abiotic indicators of target species presence"
freq_job_lit$id[freq_job_lit$sub_theme == "cost"] <-
"Barrier_Social barrier_Cost"
freq_job_lit$id[freq_job_lit$sub_theme == "discontinuity"] <-
"Barrier_Social barrier_Discontinuity"
freq_job_lit$id[freq_job_lit$sub_theme == "feasibility"] <-
"Bridge_Social bridge_Feasibility"
freq_job_lit$id[freq_job_lit$sub_theme == "model_abuse"] <-
"Barrier_Data barrier_Model abuse"
freq_job_lit$id[freq_job_lit$sub_theme == "resource_availability"] <-
"Bridge_Social bridge_Resource availability"
freq_job_lit <- freq_job_lit %>%
separate_wider_delim(id, delim = "_", names = c("bridge_barr", "code_cat", "code_name"))
freq_job_lit$bridge_barr <- factor(freq_job_lit$bridge_barr, levels = c("Bridge", "Barrier"))
freq_job_lit <- freq_job_lit %>%
mutate(fish_ship = ifelse(fish_ship == "Ship strikes", "Shipping", "Fishing"))
#calculate proportions
freq_job_lit2 <- freq_job_lit %>%
group_by(fish_ship, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(fish_ship, bridge_barr, code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(code_level = if_else(code_cat %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(code_cat %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(code_cat %in% c("Social barrier", "Social bridge"), "Social bridge or barrier", NA))),
id = paste(fish_ship, bridge_barr, code_cat)) %>%
distinct(id, .keep_all = TRUE)
#stacked bar plots
ggplot(freq_job_lit2, aes(fill=code_level, y=value, x=fish_ship)) +
geom_bar(position="stack", stat="identity") +
scale_fill_manual(values = c("#CFE2F3", "#C5E0B4","#45818E")) +
facet_wrap(~bridge_barr) +
labs(fill = "") +
guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme_ms() +
theme(legend.position = "top",
legend.justification = "left",
legend.text = element_text(size = 14, color = "black")) +
xlab("") +
ylab("Proportion of theme (%)")
View(freq_job_lit2)
freq_job_lit2 %>% group_by(fish_ship, code_cat) %>% summarise(value = value)
#radar plots
freq_job_lit3 <- freq_job_lit %>%
# group_by(fish_ship, bridge_barr) %>%
# mutate(n_total = sum(total)) %>%
# ungroup() %>%
# group_by(fish_ship, bridge_barr, code_name) %>%
# mutate(n_subtotal = sum(total)) %>%
# reframe(value = (n_subtotal/n_total)*100) %>%
# ungroup() %>%
# mutate(id = paste(fish_ship, bridge_barr, code_name)) %>%
# distinct(id, .keep_all = TRUE) %>%
# select(-c(id)) %>%
group_by(fish_ship, bridge_barr, code_name) %>%
summarise(value = sum(total))
View(freq_job_lit3)
top_lit <- freq_job_lit3 %>%
group_by(fish_ship, bridge_barr) %>%
arrange(desc(value)) %>%
top_n(3) %>%
ungroup() %>%
select(code_name)
View(top_lit)
top_bridge <- freq_job_lit3 %>%
subset(code_name %in% top_lit$code_name) %>%
filter(bridge_barr == "Bridge") %>%
pivot_wider(names_from = code_name, values_from = value) %>%
ungroup() %>%
select(-bridge_barr) %>%
mutate_all(~replace_na(., 0))
View(top_bridge)
top_barrier <- freq_job_lit3 %>%
subset(code_name %in% top_lit$code_name) %>%
filter(bridge_barr == "Barrier") %>%
pivot_wider(names_from = code_name, values_from = value) %>%
ungroup() %>%
select(-bridge_barr) %>%
mutate_all(~replace_na(., 0))
View(top_barrier)
#format data
freq_pos_survey <- code_vars_s %>%
select(c(6:10, 21:54)) %>%
janitor::clean_names() %>%
pivot_longer(1:5, names_to = "test", values_to = "position") %>%
select(-c(test)) %>%
pivot_longer(1:34, names_to = "sub_theme", values_to = "total") %>%
group_by(position, sub_theme) %>%
summarise(total = sum(total),
.groups = "drop") %>%
drop_na(position)
lib_job_survey <- code_freq_s %>%
mutate(id = paste(bridge_barr, code_cat, code_name, sep = "_")) %>%
select(id)
freq_pos_survey$id <- NA
for(i in 1:nrow(freq_pos_survey)){
curr_code = freq_pos_survey$sub_theme[i]
curr_id = lib_job_survey$id[agrepl(curr_code, lib_job_survey$id, 6)]
freq_pos_survey$id[i] <- curr_id
}
freq_pos_survey$id[freq_pos_survey$sub_theme == "stigmatization"] <- "Barrier_Social barrier_Stigmatization"
freq_pos_survey$id[freq_pos_survey$sub_theme == "cost"] <- "Barrier_Social barrier_Cost"
freq_pos_survey <- freq_pos_survey %>%
separate_wider_delim(id, delim = "_", names = c("bridge_barr", "code_cat", "code_name"))
freq_pos_survey$bridge_barr <- factor(freq_pos_survey$bridge_barr, levels = c("Bridge", "Barrier"))
#calculate proportions
freq_pos_survey2 <- freq_pos_survey %>%
group_by(position, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(position, bridge_barr, code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(code_level = if_else(code_cat %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(code_cat %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(code_cat %in% c("Social barrier", "Social bridge"), "Social bridge or barrier",
if_else(code_cat %in% c("Implementation bridge", "Implementation barrier"), "Implementation bridge or barrier", NA)))),
id = paste(position, bridge_barr, code_cat)) %>%
distinct(id, .keep_all = TRUE)
#stacked bar plots
ggplot(freq_pos_survey2, aes(fill=code_level, y=value, x=position)) +
geom_bar(position="stack", stat="identity") +
scale_fill_manual(values = c("#CFE2F3", "#C5E0B4","royalblue4","#45818E")) +
facet_wrap(~bridge_barr) +
labs(fill = "") +
theme_ms() +
theme(legend.position = "top",
legend.justification.top = "left",
legend.title = element_text(size = 16, color = "black"),
legend.text = element_text(size = 14, color = "black"))+
guides(fill=guide_legend(nrow=2,byrow=TRUE))+
xlab("") +
ylab("Proportion of theme (%)")+
theme(axis.text.x = element_text(size = 14, color = "black", angle = 60, hjust = 1))
View(freq_pos_survey2)
#format data
freq_job_lit <- code_vars %>%
select(c(1, 27:29, 33:60)) %>%
janitor::clean_names() %>%
pivot_longer(2:4, names_to = "test", values_to = "fish_ship") %>%
select(-c(test)) %>%
pivot_longer(2:29, names_to = "sub_theme", values_to = "total") %>%
group_by(fish_ship, sub_theme) %>%
summarise(total = sum(total),
.groups = "drop") %>%
filter(fish_ship == "Bycatch" | fish_ship == "Ship strikes" | fish_ship == "Overfishing" | fish_ship == "Entanglement" | fish_ship == "Avoid fisheries discharge")
lib_job_lit <- code_freq %>%
mutate(id = paste(bridge_barr, code_cat, code_name, sep = "_")) %>%
select(id)
freq_job_lit$id <- NA
for(i in 1:nrow(freq_job_lit)){
curr_code = freq_job_lit$sub_theme[i]
curr_id = lib_job_lit$id[agrepl(curr_code, lib_job_lit$id, 10)] #6 refers to the number of characters that can be diff
freq_job_lit$id[i] <- curr_id
}
freq_job_lit$id[freq_job_lit$sub_theme == "abiotic_data_availability"] <- "Bridge_Data bridge_Abiotic data availability"
freq_job_lit$id[freq_job_lit$sub_theme == "abiotic_indicators_of_target_species_presence"] <-
"Bridge_Ecological bridge_Abiotic indicators of target species presence"
freq_job_lit$id[freq_job_lit$sub_theme == "cost"] <-
"Barrier_Social barrier_Cost"
freq_job_lit$id[freq_job_lit$sub_theme == "discontinuity"] <-
"Barrier_Social barrier_Discontinuity"
freq_job_lit$id[freq_job_lit$sub_theme == "feasibility"] <-
"Bridge_Social bridge_Feasibility"
freq_job_lit$id[freq_job_lit$sub_theme == "model_abuse"] <-
"Barrier_Data barrier_Model abuse"
freq_job_lit$id[freq_job_lit$sub_theme == "resource_availability"] <-
"Bridge_Social bridge_Resource availability"
freq_job_lit <- freq_job_lit %>%
separate_wider_delim(id, delim = "_", names = c("bridge_barr", "code_cat", "code_name"))
freq_job_lit$bridge_barr <- factor(freq_job_lit$bridge_barr, levels = c("Bridge", "Barrier"))
freq_job_lit <- freq_job_lit %>%
mutate(fish_ship = ifelse(fish_ship == "Ship strikes", "Shipping", "Fishing"))
#calculate proportions
freq_job_lit2 <- freq_job_lit %>%
group_by(fish_ship, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(fish_ship, bridge_barr, code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(code_level = if_else(code_cat %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(code_cat %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(code_cat %in% c("Social barrier", "Social bridge"), "Social bridge or barrier", NA))),
id = paste(fish_ship, bridge_barr, code_cat)) %>%
distinct(id, .keep_all = TRUE)
#stacked bar plots
ggplot(freq_job_lit2, aes(fill=code_level, y=value, x=fish_ship)) +
geom_bar(position="stack", stat="identity") +
scale_fill_manual(values = c("#CFE2F3", "#C5E0B4","#45818E")) +
facet_wrap(~bridge_barr) +
labs(fill = "") +
guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme_ms() +
theme(legend.position = "top",
legend.justification = "left",
legend.text = element_text(size = 14, color = "black")) +
xlab("") +
ylab("Proportion of theme (%)")
#radar plots
freq_job_lit3 <- freq_job_lit %>%
# group_by(fish_ship, bridge_barr) %>%
# mutate(n_total = sum(total)) %>%
# ungroup() %>%
# group_by(fish_ship, bridge_barr, code_name) %>%
# mutate(n_subtotal = sum(total)) %>%
# reframe(value = (n_subtotal/n_total)*100) %>%
# ungroup() %>%
# mutate(id = paste(fish_ship, bridge_barr, code_name)) %>%
# distinct(id, .keep_all = TRUE) %>%
# select(-c(id)) %>%
group_by(fish_ship, bridge_barr, code_name) %>%
summarise(value = sum(total))
top_lit <- freq_job_lit3 %>%
group_by(fish_ship, bridge_barr) %>%
arrange(desc(value)) %>%
top_n(3) %>%
ungroup() %>%
select(code_name)
top_bridge <- freq_job_lit3 %>%
subset(code_name %in% top_lit$code_name) %>%
filter(bridge_barr == "Bridge") %>%
pivot_wider(names_from = code_name, values_from = value) %>%
ungroup() %>%
select(-bridge_barr) %>%
mutate_all(~replace_na(., 0))
top_barrier <- freq_job_lit3 %>%
subset(code_name %in% top_lit$code_name) %>%
filter(bridge_barr == "Barrier") %>%
pivot_wider(names_from = code_name, values_from = value) %>%
ungroup() %>%
select(-bridge_barr) %>%
mutate_all(~replace_na(., 0))
ggradar::ggradar(top_bridge,
values.radar = c(0, 20, 40),
background.circle.colour = "white",
axis.line.colour = "gray60",
gridline.min.colour = "gray60",
gridline.mid.colour = "gray60",
gridline.max.colour = "gray60",
group.colours = c("#F29325", "#007172"),
legend.position = "bottom",
fill = TRUE,
axis.label.size = 3)
View(top_barrier)
freq_job_lit3 %>%
group_by(fish_ship, bridge_barr) %>%
arrange(desc(value)) %>%
top_n(3) %>%
freq_job_lit3 %>%
group_by(fish_ship, bridge_barr) %>%
arrange(desc(value)) %>%
top_n(3)
