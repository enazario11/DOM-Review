legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(brba_sum, aes(x = fct_reorder(code_level, percent),
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Total bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s", ordered = TRUE),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
?fct_relevel
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Total bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s"),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$br_ba, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Total bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s"),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s"),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s")) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha")) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier", "Overall bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Ecological bridge or barrier", "Social bridge or barrier", "Data bridge or barrier", "Overall bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Social bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Overall bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
library(tidyverse)
library(tidyverse)
library(tidyquant)
library(here)
library(kableExtra)
library(waffle)
library(kableExtra)
library(waffle)
library(extrafont)
library(hrbrthemes)
library(patchwork)
code_freq <- read.csv(here("data/code_freq_032224.csv"))
codes_vars <- read.csv(here("data/code_w_vars_032224.csv"))
keywords <- read.csv(here("data/keywords_032224.csv"))
occur_all <- read.csv(here("data/code_configs_all_032224.csv"))
occur_br <- read.csv(here("data/code_configs_bridges_032224.csv"))
occur_ba <- read.csv(here("data/code_configs_barriers_032224.csv"))
#change codes to new names
#code_freq
#sp br
code_freq$code_cat <- replace(code_freq$code_cat, code_freq$code_cat == "Species bridge", "Ecological bridge")
code_freq$code_cat <- replace(code_freq$code_cat, code_freq$code_cat == "Species barrier", "Ecological barrier")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Limited Prey Resources", "Target species is a prey specialist")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Fine Scale management required", "Fine-scale management appropriate for target species")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Migratory and/or dynamic range", "Highly mobile target species")
code_freq$code_name[code_freq$code_cat == "Ecological bridge" & code_freq$code_name == "Climate change"] <- "Expected climate change induced range shifts"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Known Species Nat History", "Life history information available for target species")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Distinct Habitat between target and non-target species", "Distinct habitat preferences among species in system")
#data br
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Advances in Tech", "Access to advanced technology and techniques")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Scale appropriate for system", "Management scale aligns with system needs")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Open-Access Public Data", "Data transparency and accessibility")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Availability for species", "Target species data availability")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Stakeholder/Anthropogenic Data Access", "Resource use data availability")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Enviro Access", "Abiotic data availability")
#soc br
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Open Communication or Co-Mngmt in place", "Co-management and communication")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Adoption Interests & Incentives", "Adoption incentives for end users")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Pre-existing regulation & management institutions", "Pre-existing regulation and management institutions")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "DOM implementation feasible (Socio-econ)", "Feasibility")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Resource Availability (economical)", "Resource availability")
#sp ba
code_freq$code_cat[code_freq$code_name == "Model Abuse"] <- "Data barrier"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Switch to multi-species mngmnt", "Need for multispecies management")
#data ba
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Gaps and Accuracy", "Gaps and inaccuracy")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Model Abuse", "Model abuse")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Mismatch in scale", "Management scales do not align with system needs")
code_freq$code_cat[code_freq$code_name == "Climate change"] <- "Data barrier"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Climate change", "Climate change adding uncertainty to target species habitat use")
#soc ba
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Unintended consequences", "Indirect socioeconomic consequences")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Political permanence", "Lack of political administration permanence")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Communication & Distribution", "Poor communication and outreach")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Recipient participation", "Poor program implementation")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Cost", "Implementation costs")
bri_codes <- code_freq %>%
filter(bridge_barr == "Bridge") %>%
subset(select = -c(total, bridge_barr))
colnames(bri_codes) <- c("Code category", "Code label")
bri_codes %>%
kbl() %>%
kable_styling()
bar_codes <- code_freq %>%
filter(bridge_barr == "Barrier") %>%
subset(select = -c(total, bridge_barr))
colnames(bar_codes) <- c("Code category", "Code label")
bar_codes %>%
kbl() %>%
kable_styling()
codes_vars$broad_location <- as.factor(codes_vars$broad_location)
codes_LU <- codes_vars[!duplicated(codes_vars$Lit_unit), ]
reg_s <- codes_LU %>%
group_by(broad_location) %>%
filter(broad_location != "NA" & broad_location != "Europe and United States") %>%
summarise(count = n()) %>%
ungroup() %>%
mutate(perc = count/sum(count)*100)
reg_bar <- ggplot(reg_s) +
geom_bar(aes(x = perc, y = reorder(broad_location, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
expand = c(0,0),
limits = c(0, 48))+
scale_y_discrete(expand = expansion(add = c(0.5,0.5))) +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# Remove labels from the vertical axis
axis.text.y = element_blank(),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 12)) +
geom_text(aes(x = perc, y = broad_location, label = broad_location),
hjust = 0,
nudge_x = 0.3,
colour = "dodgerblue4",
family = "Econ Sans Cnd",
size = 3.5)+
labs(subtitle = "Percent of sum from all articles (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 13)
)
reg_bar
codes_vars2 = codes_vars
colnames(codes_vars2) <- gsub(x = colnames(codes_vars2), pattern = "\\.", replacement = " ")
#calculate frequency of bridges vs. barriers being mentioned in articles -- need to add biotic and abiotic indicators cols
code_freq_new <- codes_vars2 %>%
mutate(br_pos = as.numeric(if_any(33:48, ~. == 1)),
ba_pos = as.numeric(if_any(49:58, ~. == 1)),
br_dat = as.numeric(if_any(c("Management scale aligns with system needs", "Target species data availability", "Access to advanced technology and techniques", "Data transparency and accessibility", "Abiotic data availability", "Resource use data availability"), ~. == 1)),
br_eco = as.numeric(if_any(c("Expected climate change induced range shifts", "Distinct habitat preferences among species in system", "Highly mobile target species", "Target species is a prey specialist", "Life history information available for target species", "Fine scale management appropriate for target species"), ~. == 1)),
br_soc = as.numeric(if_any(c("Resource availability", "Pre existing regulation and management institutions", "Adoption incentives for end users", "Feasibility", "Co management and communication"), ~. == 1)),
ba_dat = as.numeric(if_any(c("Implementation costs", "Gaps and inaccuracy", "Management scales do not align with system needs", "Model abuse", "Climate change adding uncertainty to target species habitat use"), ~. == 1)),
ba_eco = as.numeric(if_any(c("Need for multispecies management"), ~. == 1)),
ba_soc = as.numeric(if_any(c("Indirect socioeconomic consequences", "Lack of political administration permanence", "Poor communication and outreach", "Poor program implementation"), ~. == 1)))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha")) %>%
group_by(code_level)
#calculate frequency of bridges vs. barriers being mentioned in articles -- need to add biotic and abiotic indicators cols
code_freq_new <- codes_vars2 %>%
mutate(br_pos = as.numeric(if_any(33:48, ~. == 1)),
ba_pos = as.numeric(if_any(49:58, ~. == 1)),
br_dat = as.numeric(if_any(c("Management scale aligns with system needs", "Target species data availability", "Access to advanced technology and techniques", "Data transparency and accessibility", "Abiotic data availability", "Resource use data availability"), ~. == 1)),
br_eco = as.numeric(if_any(c("Expected climate change induced range shifts", "Distinct habitat preferences among species in system", "Highly mobile target species", "Target species is a prey specialist", "Life history information available for target species", "Fine scale management appropriate for target species"), ~. == 1)),
br_soc = as.numeric(if_any(c("Resource availability", "Pre existing regulation and management institutions", "Adoption incentives for end users", "Feasibility", "Co management and communication"), ~. == 1)),
ba_dat = as.numeric(if_any(c("Implementation costs", "Gaps and inaccuracy", "Management scales do not align with system needs", "Model abuse", "Climate change adding uncertainty to target species habitat use"), ~. == 1)),
ba_eco = as.numeric(if_any(c("Need for multispecies management"), ~. == 1)),
ba_soc = as.numeric(if_any(c("Indirect socioeconomic consequences", "Lack of political administration permanence", "Poor communication and outreach", "Poor program implementation"), ~. == 1)))
