scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 10))
code_vars_pos <- code_vars_pos %>% mutate(pos_type = as.factor(pos_type))
code_vars_pos$pos_type <- factor(code_vars_pos$pos_type , levels = c("Fishery advisory board member", "Vessel operator", "Vessel captain", "Fleet manager", "Fishery manager", "Crew", "Commercial fisherman", "Vessel owner", "Fishery scientist", "NA"))
ggplot(code_vars_pos, aes(x = "", fill = pos_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 10))
code_vars_pos$pos_type <- factor(code_vars_pos$pos_type , levels = c("Vessel operator", "Vessel captain", "Fleet manager", "Fishery manager", "Crew", "Commercial fisherman", "Vessel owner", "Fishery advisory board member","Fishery scientist", "NA"))
ggplot(code_vars_pos, aes(x = "", fill = pos_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 10))
code_vars_pos$pos_type <- factor(code_vars_pos$pos_type , levels = c("Vessel operator", "Vessel captain", "Fleet manager", "Crew", "Commercial fisherman","Fishery advisory board member", "Fishery manager", "Vessel owner", "Fishery scientist", "NA"))
ggplot(code_vars_pos, aes(x = "", fill = pos_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 10))
code_vars_pos$pos_type <- factor(code_vars_pos$pos_type , levels = c("Vessel operator", "Crew", "Vessel captain", "Fleet manager", "Fishery advisory board member", "Fishery manager", "Commercial fisherman", "Vessel owner", "Fishery scientist", "NA"))
ggplot(code_vars_pos, aes(x = "", fill = pos_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 10))
code_vars_pos$pos_type <- factor(code_vars_pos$pos_type , levels = c("Vessel operator", "Crew", "Vessel captain", "Fleet manager", "Fishery manager", "Commercial fisherman", "Fishery advisory board member", "Vessel owner", "Fishery scientist", "NA"))
ggplot(code_vars_pos, aes(x = "", fill = pos_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 10))
ggplot(code_vars_s, aes(x = "", pos_num))+
geom_violin()+
theme_minimal()
ggplot(code_vars_s, aes(x = "", pos_num))+
geom_violin()+
geom_jitter(height = 0, width = 0.1)+
theme_minimal() +
xlab("")+
ylab("Number of years in position")
ggplot(code_vars_s, aes(x = "", pos_num))+
geom_violin(size = 2)+
geom_jitter(height = 0, width = 0.1)+
theme_minimal() +
xlab("")+
ylab("Number of years in position")
?geom_jitter
ggplot(code_vars_s, aes(x = "", pos_num))+
geom_violin(size = 1.5)+
geom_jitter(height = 0, width = 0.1, size = 2)+
theme_minimal() +
xlab("")+
ylab("Number of years in position")
ggplot(code_vars_s, aes(x = "", pos_num))+
geom_violin(size = 1.5, color = "steelblue4")+
geom_jitter(height = 0, width = 0.1, size = 2, color = "goldenrod4")+
theme_minimal() +
xlab("")+
ylab("Number of years in position")+
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 14, color = "black"))
ggplot(code_vars_s, aes(x = "", pos_num))+
geom_violin(size = 1.5, color = "steelblue4")+
geom_jitter(height = 0, width = 0.1, size = 3, color = "goldenrod", alpha = 0.8)+
theme_minimal() +
xlab("")+
ylab("Number of years in position")+
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 14, color = "black"))
ggplot(code_vars_s, aes(x = "", pos_num))+
geom_violin(size = 1.5, color = "steelblue4")+
geom_jitter(height = 0, width = 0.1, size = 3, color = "goldenrod", alpha = 0.5)+
theme_minimal() +
xlab("")+
ylab("Number of years in position")+
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 14, color = "black"))
ggplot(code_vars_s, aes(x = "", pos_num))+
geom_violin(size = 1.5, color = "steelblue4")+
geom_jitter(height = 0, width = 0.1, size = 3, color = "steelblue4", alpha = 0.5)+
theme_minimal() +
xlab("")+
ylab("Number of years in position")+
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 14, color = "black"))
ggplot(code_vars_pos, aes(x = "", fill = pos_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 10))
ggplot(code_vars_pos, aes(x = "", fill = pos_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of respondants")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 10))
#| echo: false
#| message: false
#| warning: false
#| fig-width: 7
#| fig-height: 4
#| fig-align: center
code_vars_s <- code_vars_s %>% mutate(survey = as.factor(survey))
unique(code_var_s$survey)
unique(code_vars_s$survey)
ggplot(code_vars_s, aes(x = "", fill = survey))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of survey respondants")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 4))
code_vars_s$survey <- factor(code_vars_s$survey , levels = c("Yellowtail surveys", "WhaleWatch surveys", "WhaleWatch TMMC surveys", "Shad surveys"))
ggplot(code_vars_s, aes(x = "", fill = survey))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of survey respondants")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 4))
code_vars_s$survey <- factor(code_vars_s$survey , levels = c("Shad surveys","WhaleWatch TMMC surveys","WhaleWatch surveys", "Yellowtail surveys"))
ggplot(code_vars_s, aes(x = "", fill = survey))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of survey respondants")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 4))
ggplot(code_vars_s, aes(x = "", fill = survey))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of survey respondants")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 4))+
scale_fill_discrete(labels = c("River Herring Avoidance Program", "Whale Safe Southern California", "Whale Safe Northern California", "Yellowtail Flounder Avoidance Program"))
ggplot(code_vars_s, aes(x = "", fill = survey))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Respondant position")+
ylab("Percentage of survey respondants")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 4), labels = c("River Herring Avoidance Program", "Whale Safe Southern California", "Whale Safe Northern California", "Yellowtail Flounder Avoidance Program"))
#| include: false
#| echo: false
#| warning: false
#| message: false
library(tidyverse)
library(tidyquant)
library(here)
library(kableExtra)
library(waffle)
library(extrafont)
library(hrbrthemes)
library(patchwork)
library(ggalluvial)
library(ggrepel)
library(forcats)
#lit data
code_freq <- read.csv(here("data/code_freq.csv"))
codes_vars <- read.csv(here("data/code_w_vars.csv"))
keywords <- read.csv(here("data/keywords.csv"))
code_rel <- read.csv(here("data/code_rel.csv"))
#survey data
code_vars_s <- read.csv(here("data/surveys/draft_vars.csv"))
#change codes to new names
#code_freq
#sp br
code_freq$code_cat <- replace(code_freq$code_cat, code_freq$code_cat == "Species bridge", "Ecological bridge")
code_freq$code_cat <- replace(code_freq$code_cat, code_freq$code_cat == "Species barrier", "Ecological barrier")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Limited Prey Resources", "Target species is a prey specialist")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Fine Scale management required", "Fine-scale management appropriate for target species")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Migratory and/or dynamic range", "Highly mobile target species")
code_freq$code_name[code_freq$code_cat == "Ecological bridge" & code_freq$code_name == "Climate change"] <- "Expected climate change induced range shifts"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Known Species Nat History", "Life history information available for target species")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Distinct Habitat between target and non-target species", "Distinct habitat preferences among species in system")
#data br
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Advances in Tech", "Access to advanced technology and techniques")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Scale appropriate for system", "Management scale aligns with system needs")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Open-Access Public Data", "Data transparency and accessibility")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Availability for species", "Target species data availability")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Stakeholder/Anthropogenic Data Access", "Resource use data availability")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Enviro Access", "Abiotic data availability")
#soc br
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Open Communication or Co-Mngmt in place", "Co-management and communication")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Adoption Interests & Incentives", "Adoption incentives for end users")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Pre-existing regulation & management institutions", "Pre-existing regulation and management institutions")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "DOM implementation feasible (Socio-econ)", "Feasibility")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Resource Availability (economical)", "Resource availability")
#sp ba
code_freq$code_cat[code_freq$code_name == "Model Abuse"] <- "Data barrier"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Switch to multi-species mngmnt", "Need for multispecies management")
#data ba
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Gaps and Accuracy", "Gaps and inaccuracy")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Model Abuse", "Model abuse")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Mismatch in scale", "Management scales do not align with system needs")
code_freq$code_cat[code_freq$code_name == "Climate change"] <- "Data barrier"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Climate change", "Climate change adding uncertainty to target species habitat use")
#soc ba
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Unintended consequences", "Indirect socioeconomic consequences")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Political permanence", "Lack of political administration permanence")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Communication & Distribution", "Poor communication and outreach")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Recipient participation", "Poor program implementation")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Cost", "Implementation costs")
#| echo: false
#| message: false
#| warning: false
#| fig-width: 7
#| fig-height: 4
codes_vars$lit_type <- factor(codes_vars$lit_type , levels = c("NOAA Rule", "NMFS Notice", "Book chapter", "Thesis", "Methods", "Perspective", "Review", "Study"))
codes_vars <- codes_vars %>% group_by(lit_type) %>% mutate(lit_perc = nrow(lit_type)/710)
codes_vars$lit_type <- factor(codes_vars$lit_type , levels = c("NOAA Rule", "NMFS Notice", "Book chapter", "Thesis", "Methods", "Perspective", "Review", "Study"))
ggplot(codes_vars, aes(x = "", fill = lit_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Literature category")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 8))
#| echo: false
#| message: false
#| warning: false
#| fig-width: 15
#| fig-height: 15
#calc props for sankey_df csv (fine scale codes are raw totals from code_freq file)
sum_codes <- sum(code_freq$total) #710 codes
code_freq %>%
group_by(bridge_barr) %>%
summarise(totals = sum(total))
code_freq %>%
group_by(code_cat) %>%
summarise(totals = sum(total))
#load sankey df
sankey_df <- read.csv(here("data/sankey_freq.csv"))
sankey_df$code_cat <- factor(sankey_df$code_cat, levels = c("Ecological barrier", "Data barrier", "Social barrier", "Data bridge", "Ecological bridge", "Social bridge"))
sankey_df <- sankey_df %>%
mutate(sum_codes = sum(total),
perc_codes = (total/sum_codes)*100,
round_perc = round(perc_codes, 0))
ggplot(data = sankey_df,
aes(axis1 = fct_reorder(bridge_barr, -perc_codes), axis2 = fct_reorder(code_cat, -perc_codes), axis3 = fct_reorder(code_name, -perc_codes), y = perc_codes)) +
geom_alluvium(aes(fill = code_cat, color = code_cat), size = 1.5, alpha = 0.8, width = 0.05) +
geom_stratum(size = 1.5, color = "grey60",
width = c(1/12,1/12,1/3,1/3,1/3,1/3,1/3,1/3,1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18)) +
geom_text(stat = "stratum",
aes(label = after_stat(stratum)),
angle = c(90,90,0,0,0,0,0,0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
size = c(7,7,5,5,5,5,5,5,4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4),
nudge_y = c(0,0,0,0,0,0,0,0,0, #poor communication and outreach
0.5, #model abuse
1, #lack of political permanance
1.5, #indirect socioeconomic consequences
1.8, #target species is a prey specialist
2, #resource availability
2, #climate change adding uncertainty
2, #data transparency
2, #need for multi-species management
2, #distinct habitat preference
2, #fine scale management
1.5, #management scale system needs
2, #management scale aligns
0.8, #feasibility
0,0,0,0,0,0,0,0,0,0,0,0,0,0),
nudge_x = c(-0.01,-0.01,0,0,0,0,0,0,0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05,   0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05),
hjust = c(0.5, 0.5, 0.5,0.5,0.5,0.5,0.5,0.5,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)) +
xlim(0.89, 3.6) +
ylim(-1, 100)+
labs(y = "Percent of all codes (%)", x = "") +
theme_minimal()+
theme(axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 16),
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major = element_blank())+
scale_fill_manual(values = c("#F48136", "#F46036", "#F44336", "#CFE2F3", "#C5E0B4", "#45818E"))+
scale_color_manual(values = c("#F48136", "#F46036", "#F44336", "#CFE2F3", "#C5E0B4", "#45818E"))
ggplot(data = sankey_df,
aes(axis1 = fct_reorder(bridge_barr, -perc_codes), axis2 = fct_reorder(code_cat, -perc_codes), axis3 = fct_reorder(code_name, -perc_codes), y = perc_codes)) +
geom_alluvium(aes(fill = code_cat, color = code_cat), size = 1.5, alpha = 0.8, width = 0.05) +
geom_stratum(size = 1.5, color = "grey60",
width = c(1/12,1/12,1/3,1/3,1/3,1/3,1/3,1/3,1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18)) +
geom_text(stat = "stratum",
aes(label = after_stat(stratum)),
angle = c(90,90,0,0,0,0,0,0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
size = c(7,7,5,5,5,5,5,5,4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4),
nudge_y = c(0,0,0,0,0,0,0,0,0, #poor communication and outreach
0.5, #model abuse
1, #lack of political permanance
1.5, #indirect socioeconomic consequences
1.8, #target species is a prey specialist
2, #resource availability
2, #climate change adding uncertainty
2, #data transparency
2, #need for multi-species management
2, #distinct habitat preference
2, #fine scale management
1.5, #management scale system needs
2, #management scale aligns
0.8, #feasibility
0,0,0,0,0,0,0,0,0,0,0,0,0,0),
nudge_x = c(-0.01,-0.01,0,0,0,0,0,0,0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05,   0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05),
hjust = c(0.5, 0.5, 0.5,0.5,0.5,0.5,0.5,0.5,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)) +
xlim(0.89, 3.6) +
ylim(-1, 100)+
labs(y = "Percent of all codes (%)", x = "") +
theme_minimal()+
theme(axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 16),
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major = element_blank())+
scale_fill_manual(values = c("#F48136", "#F46036", "#F44336", "#CFE2F3", "#C5E0B4", "#45818E"))+
scale_color_manual(values = c("#F48136", "#F46036", "#F44336", "#CFE2F3", "#C5E0B4", "#45818E"))
#| include: false
#| echo: false
#| warning: false
#| message: false
library(tidyverse)
library(tidyquant)
library(here)
library(kableExtra)
library(waffle)
library(extrafont)
library(hrbrthemes)
library(patchwork)
library(ggalluvial)
library(ggrepel)
library(forcats)
#lit data
code_freq <- read.csv(here("data/code_freq.csv"))
codes_vars <- read.csv(here("data/code_w_vars.csv"))
keywords <- read.csv(here("data/keywords.csv"))
code_rel <- read.csv(here("data/code_rel.csv"))
#survey data
code_vars_s <- read.csv(here("data/surveys/draft_vars.csv"))
#change codes to new names
#code_freq
#sp br
code_freq$code_cat <- replace(code_freq$code_cat, code_freq$code_cat == "Species bridge", "Ecological bridge")
code_freq$code_cat <- replace(code_freq$code_cat, code_freq$code_cat == "Species barrier", "Ecological barrier")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Limited Prey Resources", "Target species is a prey specialist")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Fine Scale management required", "Fine-scale management appropriate for target species")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Migratory and/or dynamic range", "Highly mobile target species")
code_freq$code_name[code_freq$code_cat == "Ecological bridge" & code_freq$code_name == "Climate change"] <- "Expected climate change induced range shifts"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Known Species Nat History", "Life history information available for target species")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Distinct Habitat between target and non-target species", "Distinct habitat preferences among species in system")
#data br
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Advances in Tech", "Access to advanced technology and techniques")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Scale appropriate for system", "Management scale aligns with system needs")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Open-Access Public Data", "Data transparency and accessibility")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Availability for species", "Target species data availability")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Stakeholder/Anthropogenic Data Access", "Resource use data availability")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Enviro Access", "Abiotic data availability")
#soc br
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Open Communication or Co-Mngmt in place", "Co-management and communication")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Adoption Interests & Incentives", "Adoption incentives for end users")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Pre-existing regulation & management institutions", "Pre-existing regulation and management institutions")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "DOM implementation feasible (Socio-econ)", "Feasibility")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Resource Availability (economical)", "Resource availability")
#sp ba
code_freq$code_cat[code_freq$code_name == "Model Abuse"] <- "Data barrier"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Switch to multi-species mngmnt", "Need for multispecies management")
#data ba
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Gaps and Accuracy", "Gaps and inaccuracy")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Model Abuse", "Model abuse")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Mismatch in scale", "Management scales do not align with system needs")
code_freq$code_cat[code_freq$code_name == "Climate change"] <- "Data barrier"
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Climate change", "Climate change adding uncertainty to target species habitat use")
#soc ba
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Unintended consequences", "Indirect socioeconomic consequences")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Political permanence", "Lack of political administration permanence")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Communication & Distribution", "Poor communication and outreach")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Recipient participation", "Poor program implementation")
code_freq$code_name <- replace(code_freq$code_name, code_freq$code_name == "Cost", "Implementation costs")
#| echo: false
#| message: false
#| warning: false
#| fig-width: 7
#| fig-height: 4
codes_vars$lit_type <- factor(codes_vars$lit_type , levels = c("NOAA Rule", "NMFS Notice", "Book chapter", "Thesis", "Methods", "Perspective", "Review", "Study"))
ggplot(codes_vars, aes(x = "", fill = lit_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Literature category")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 8))
ggplot(codes_vars, aes(x = "", fill = lit_type))+
geom_bar(position = "fill")+
xlab("")+
theme_minimal()+
labs(fill = "Literature category")+
ylab("Percentage of articles")+
coord_flip()+
scale_y_continuous(labels = scales::percent)+
scale_fill_manual(values = MetBrewer::met.brewer("Veronese", n = 8))+
theme(panel.background = element_rect(fill='transparent'),
plot.background = element_rect(fill='transparent', color=NA),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill='transparent'),
legend.box.background = element_rect(fill='transparent'))
ggsave(here("figures/lit_cat.svg"), width = 8, height = 4, units = c("in"))
#| echo: false
#| message: false
#| warning: false
#| fig-width: 15
#| fig-height: 15
#calc props for sankey_df csv (fine scale codes are raw totals from code_freq file)
sum_codes <- sum(code_freq$total) #710 codes
code_freq %>%
group_by(bridge_barr) %>%
summarise(totals = sum(total))
code_freq %>%
group_by(code_cat) %>%
summarise(totals = sum(total))
#load sankey df
sankey_df <- read.csv(here("data/sankey_freq.csv"))
sankey_df$code_cat <- factor(sankey_df$code_cat, levels = c("Ecological barrier", "Data barrier", "Social barrier", "Data bridge", "Ecological bridge", "Social bridge"))
sankey_df <- sankey_df %>%
mutate(sum_codes = sum(total),
perc_codes = (total/sum_codes)*100,
round_perc = round(perc_codes, 0))
ggplot(data = sankey_df,
aes(axis1 = fct_reorder(bridge_barr, -perc_codes), axis2 = fct_reorder(code_cat, -perc_codes), axis3 = fct_reorder(code_name, -perc_codes), y = perc_codes)) +
geom_alluvium(aes(fill = code_cat, color = code_cat), size = 1.5, alpha = 0.8, width = 0.05) +
geom_stratum(size = 1.5, color = "grey60",
width = c(1/12,1/12,1/3,1/3,1/3,1/3,1/3,1/3,1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18, 1/18)) +
geom_text(stat = "stratum",
aes(label = after_stat(stratum)),
angle = c(90,90,0,0,0,0,0,0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
size = c(7,7,5,5,5,5,5,5,4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4),
nudge_y = c(0,0,0,0,0,0,0,0,0, #poor communication and outreach
0.5, #model abuse
1, #lack of political permanance
1.5, #indirect socioeconomic consequences
1.8, #target species is a prey specialist
2, #resource availability
2, #climate change adding uncertainty
2, #data transparency
2, #need for multi-species management
2, #distinct habitat preference
2, #fine scale management
1.5, #management scale system needs
2, #management scale aligns
0.8, #feasibility
0,0,0,0,0,0,0,0,0,0,0,0,0,0),
nudge_x = c(-0.01,-0.01,0,0,0,0,0,0,0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05,   0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05),
hjust = c(0.5, 0.5, 0.5,0.5,0.5,0.5,0.5,0.5,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)) +
xlim(0.89, 3.6) +
ylim(-1, 100)+
labs(y = "Percent of all codes (%)", x = "") +
theme_minimal()+
theme(axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 16),
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major = element_blank())+
scale_fill_manual(values = c("#F48136", "#F46036", "#F44336", "#CFE2F3", "#C5E0B4", "#45818E"))+
scale_color_manual(values = c("#F48136", "#F46036", "#F44336", "#CFE2F3", "#C5E0B4", "#45818E"))
ggsave(here("figures/sankey_tp.svg"), height = 9, width = 6, units = c("in"))
ggsave(here("figures/sankey_tp.svg"), height = 9, width = 8, units = c("in"))
ggsave(here("figures/sankey_tp.svg"), height = 10, width = 9, units = c("in"))
ggsave(here("figures/sankey_tp.svg"), height = 10, width = 10, units = c("in"))
ggsave(here("figures/sankey_tp.svg"), height = 10, width = 11, units = c("in"))
ggsave(here("figures/sankey_tp.svg"), height = 10, width = 12, units = c("in"))
ggsave(here("figures/sankey_tp.svg"), height = 10, width = 16, units = c("in"))
ggsave(here("figures/sankey_tp.svg"), height = 10, width = 20, units = c("in"))
ggsave(here("figures/sankey_tp.svg"), height = 10, width = 10, units = c("in"))
