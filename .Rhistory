legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 4) +
ylim(-0.55,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggsave("figures/ms_figs/all_freq/all_freq_survey.png", width = 9, height = 6, units = ("in"))
ggsave("figures/ms_figs/all_freq/all_freq_survey.png", width = 15, height = 10, units = ("in"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.55,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggsave("figures/ms_figs/all_freq/all_freq_survey.png", width = 13, height = 8, units = ("in"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.55,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 18, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 18)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggsave("figures/ms_figs/all_freq/all_freq_survey.png", width = 13, height = 8, units = ("in"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.55,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 24, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 18, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 18)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggsave("figures/ms_figs/all_freq/all_freq_survey.png", width = 13, height = 8, units = ("in"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.55,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 26, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 20, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 18)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggsave("figures/ms_figs/all_freq/all_freq_survey.png", width = 13, height = 8, units = ("in"))
#bridge freq
#reformat data
code_sum_br_s <- code_freq_s %>%
filter(bridge_barr == "Bridge") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
br_freq_s <- ggplot(code_sum_br_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
# scale_x_continuous(limits = c(0, 30),
#                    breaks = seq(0, 30, 5),
#                    name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
scale_x_reverse(limits = c(30, 0),
#breaks = seq(0, 30, 5),
name = "Percent appearance (%)")+
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#barrier freq
#reformat data
code_sum_ba_s <- code_freq_s %>%
filter(bridge_barr == "Barrier") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#barrier freq
#reformat data
code_sum_ba_s <- code_freq_s %>%
filter(bridge_barr == "Barrier") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
ba_freq_s <- ggplot(code_sum_ba_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 30),
breaks = seq(0, 30, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
code_sum_ba_s
br_freq_s
ba_freq_s
#plot
br_freq_s <- ggplot(code_sum_br_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
# scale_x_continuous(limits = c(0, 30),
#                    breaks = seq(0, 30, 5),
#                    name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
scale_x_reverse(limits = c(20, 0),
#breaks = seq(0, 30, 5),
name = "Percent appearance (%)")+
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ba_freq_s <- ggplot(code_sum_ba_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
br_freq_s <- ggplot(code_sum_br_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
# scale_x_continuous(limits = c(0, 30),
#                    breaks = seq(0, 30, 5),
#                    name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
scale_x_reverse(limits = c(20, 0),
#breaks = seq(0, 30, 5),
name = "Percent appearance (%)")+
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
br_freq_s
#bridge freq
#reformat data
code_freq_s$code_level <- factor(code_freq_s$code_level, levels = c("Implementation bridge or barrier", "Social bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier"))
#bridge freq
#reformat data
code_freq_s$code_cat <- factor(code_freq_s$code_cat, levels = c("Implementation bridge or barrier", "Social bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier"))
code_sum_br_s <- code_freq_s %>%
filter(bridge_barr == "Bridge") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
br_freq_s <- ggplot(code_sum_br_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
# scale_x_continuous(limits = c(0, 30),
#                    breaks = seq(0, 30, 5),
#                    name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
scale_x_reverse(limits = c(20, 0),
#breaks = seq(0, 30, 5),
name = "Percent appearance (%)")+
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
br_freq_s
View(code_freq_s)
code_freq_s <- read.csv(here("data/surveys/code_freq.csv"))
head(code_freq_s)
#bridge freq
#reformat data
code_freq_s$code_cat <- factor(code_freq_s$code_cat, levels = c("Implementation bridge","Implementation barrier", "Social bridge", "Social barrier", "Ecological bridge", "Ecological barrier", "Data bridge", "Data barrier"))
code_sum_br_s <- code_freq_s %>%
filter(bridge_barr == "Bridge") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
br_freq_s <- ggplot(code_sum_br_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
# scale_x_continuous(limits = c(0, 30),
#                    breaks = seq(0, 30, 5),
#                    name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
scale_x_reverse(limits = c(20, 0),
#breaks = seq(0, 30, 5),
name = "Percent appearance (%)")+
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
br_freq_s
#bridge freq
#reformat data
code_freq_s$code_cat <- factor(code_freq_s$code_cat, levels = c("Data bridge", "Data barrier", "Ecological bridge", "Ecological barrier", "Social bridge", "Social barrier", "Implementation bridge","Implementation barrier"))
code_sum_br_s <- code_freq_s %>%
filter(bridge_barr == "Bridge") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
br_freq_s <- ggplot(code_sum_br_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
# scale_x_continuous(limits = c(0, 30),
#                    breaks = seq(0, 30, 5),
#                    name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
scale_x_reverse(limits = c(20, 0),
#breaks = seq(0, 30, 5),
name = "Percent appearance (%)")+
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
br_freq_s
ggsave("figures/ms_figs/all_freq/br_freq_survey.png", width = 7, height = 8, units = c("in"))
#barrier freq
#reformat data
code_sum_ba_s <- code_freq_s %>%
filter(bridge_barr == "Barrier") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
ba_freq_s <- ggplot(code_sum_ba_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ba_freq_s
ggsave("figures/ms_figs/all_freq/ba_freq.png", width = 8, height = 8, units = c("in"))
ggsave("figures/ms_figs/all_freq/ba_freq_survey.png", width = 8, height = 8, units = c("in"))
#plot
ba_freq <- ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 30),
breaks = seq(0, 30, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ba_freq
ggsave("figures/ms_figs/all_freq/ba_freq.png", width = 8, height = 8, units = c("in"))
br_freq_s
ggsave("figures/ms_figs/all_freq/br_freq_survey.png", width = 6, height = 8, units = c("in"))
ba_freq_s
ggsave("figures/ms_figs/all_freq/ba_freq_survey.png", width = 6, height = 8, units = c("in"))
br_freq_s
ggsave("figures/ms_figs/all_freq/br_freq_survey.png", width = 6, height = 10, units = c("in"))
ba_freq_s
ggsave("figures/ms_figs/all_freq/ba_freq_survey.png", width = 6, height = 9, units = c("in"))
br_freq_s
ggsave("figures/ms_figs/all_freq/br_freq_survey.png", width = 6, height = 8, units = c("in"))
#plot
ba_freq_s <- ggplot(code_sum_ba_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 15, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ba_freq_s
ggsave("figures/ms_figs/all_freq/ba_freq_survey.png", width = 6, height = 9, units = c("in"))
#plot
ba_freq_s <- ggplot(code_sum_ba_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 16, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ba_freq_s
ggsave("figures/ms_figs/all_freq/ba_freq_survey.png", width = 6, height = 9, units = c("in"))
#plot
ba_freq <- ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 30),
breaks = seq(0, 30, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 1),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ba_freq
ggsave("figures/ms_figs/all_freq/ba_freq.png", width = 8, height = 8, units = c("in"))
#plot
ba_freq_s <- ggplot(code_sum_ba_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 16, hjust = 1),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ba_freq_s
ggsave("figures/ms_figs/all_freq/ba_freq_survey.png", width = 6, height = 9, units = c("in"))
View(codes_vars)
head(codes_vars)
codes_LU
codes_LU <- codes_vars[!duplicated(codes_vars$Lit_unit), ]
consv <- codes_LU %>%
gather(col, consv_topic, reason1:reason3) %>%
subset(select = consv_topic)
head(consv)
consv_s <- consv %>%
group_by(consv_topic) %>%
filter(consv_topic != "NA") %>%
summarise(count = n()) %>%
ungroup() %>%
mutate(perc = count/sum(count)*100)
View(consv_s)
consv_bar <- ggplot(consv_s) +
geom_bar(aes(x = perc, y = reorder(consv_topic, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
expand = c(0,0),
limits = c(0, 45))+
scale_y_discrete(expand = expansion(add = c(0,0))) +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# Remove labels from the vertical axis
axis.text.y = element_blank(),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Arial", size = 12)) +
geom_text(aes(x = perc, y = consv_topic, label = consv_topic),
hjust = 0,
nudge_x = 0.3,
colour = "dodgerblue4",
family = "Arial",
size = 3.5)+
labs(subtitle = "Percent of sum from all articles (%)") +
theme(plot.subtitle = element_text(
family = "Arial",
size = 13)
)
consv_bar
