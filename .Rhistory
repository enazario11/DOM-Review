ungroup() %>%
group_by(code_name) %>%
summarise(value = total/n_total) %>%
mutate(code_cat = ifelse(category == "Need for multispecies management", "Ecological barrier", "Ecological bridge")) %>%
mutate(percent_label = scales::percent(value, accuracy = 2))
eco_sum <- eco_freq %>%
group_by(bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(code_name) %>%
summarise(value = total/n_total) %>%
mutate(code_cat = ifelse(code_cat == "Need for multispecies management", "Ecological barrier", "Ecological bridge")) %>%
mutate(percent_label = scales::percent(value, accuracy = 2))
eco_sum <- eco_freq %>%
group_by(bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(code_name) %>%
summarise(value = total/n_total) %>%
mutate(code_cat = ifelse(code_name == "Need for multispecies management", "Ecological barrier", "Ecological bridge")) %>%
mutate(percent_label = scales::percent(value, accuracy = 2))
eco_sum$code_cat <- factor(as.factor(eco_sum$code_cat), levels = c("Ecological bridge", "Ecological barrier"))
ggplot(eco_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.9),
expand = c(0,0),
breaks = c(0, 0.25, 0.5, 0.75),
labels = my_labs)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all ecological bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
ggplot(eco_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.9),
expand = c(0,0),
breaks = c(0, 0.25, 0.5, 0.75),
labels = my_labs)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all ecological bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
View(eco_sum)
my_labs2 <- c("0", "30")
ggplot(eco_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.9),
expand = c(0,0),
breaks = c(0, 0.3),
labels = my_labs2)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all ecological bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
ggplot(eco_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.3),
expand = c(0,0),
breaks = c(0, 0.3),
labels = my_labs2)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all ecological bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
ggplot(eco_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.3),
expand = c(0,0),
breaks = c(0, 0.35),
labels = my_labs2)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all ecological bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
ggplot(eco_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.35),
expand = c(0,0),
breaks = c(0, 0.3),
labels = my_labs2)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all ecological bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
soc_freq <- code_freq %>%
filter(code_cat == "Social bridge" | code_cat == "Social barrier")
soc_sum <- soc_freq %>%
group_by(bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(code_name) %>%
summarise(value = total/n_total) %>%
mutate(code_cat = ifelse(code_name == "Indirect socioeconomic consequences" | code_name == "Lack of political administration permanence" | code_name == "Poor communication and outreach" | code_name == "Poor program implementation", "Social barrier", "Social bridge")) %>%
mutate(percent_label = scales::percent(value, accuracy = 2))
soc_sum$code_cat <- factor(as.factor(soc_sum$code_cat), levels = c("Social bridge", "Social barrier"))
View(soc_sum)
ggplot(soc_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.8),
expand = c(0,0),
breaks = c(0, 0.3),
labels = my_labs)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all social bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
ggplot(soc_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,1),
expand = c(0,0),
breaks = c(0,0.25, 0.5, 0.75),
labels = my_labs)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all social bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
ggplot(soc_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,1),
expand = c(0,0),
breaks = c(0,0.25, 0.5, 0.75),
labels = my_labs)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all social bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
ggplot(eco_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.35),
expand = c(0,0),
breaks = c(0, 0.3),
labels = my_labs2)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all ecological bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
eco_sum <- eco_freq %>%
group_by(bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(code_name) %>%
summarise(value = total/n_total) %>%
mutate(code_cat = ifelse(code_name == "Need for multispecies management", "Ecological barrier", "Ecological bridge")) %>%
mutate(percent_label = scales::percent(value, accuracy = 2))
eco_sum$code_cat <- factor(as.factor(eco_sum$code_cat), levels = c("Ecological bridge", "Ecological barrier"))
my_labs2 <- c("0", "30")
ggplot(eco_sum) +
geom_bar(aes(x = value, y = reorder(code_name, value), fill = code_cat), width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
limits = c(0,0.35),
expand = c(0,0),
breaks = c(0, 0.3),
labels = my_labs2)+
scale_y_discrete(expand = expansion(add = c(0,0))) +
tidyquant::theme_tq() +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Econ Sans Cnd", size = 16),
axis.text.y = element_text(family = "Econ Sans Cnd", size = 16),
legend.position = "none",
strip.text = element_text(size = 16)) +
geom_text(aes(x = value, y = code_name, label = percent_label),
hjust = 0,
nudge_x = -0.0001,
colour = "black",
family = "Econ Sans Cnd",
size = 6)+
labs(subtitle = "Percent of sum from all ecological bridges or barriers (%)") +
theme(plot.subtitle = element_text(
family = "Econ Sans Cnd",
size = 20)
) +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"))+
facet_wrap(~code_cat, scales = "free", nrow = 2)
ggplot(code_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 7) +
ylim(-0.4,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.21, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(code_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 7) +
ylim(-0.4,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.21, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
