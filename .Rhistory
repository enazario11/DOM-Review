View(brba_sum_s)
brba_sum_s <- code_freq_new_s %>%
summarise(n_br = sum(br_pos), freq_br = n_br/21,
n_ba = sum(ba_pos), freq_ba = n_ba/21,
n_br_e = sum(br_eco), freq_br_e = n_br_e/21,
n_br_d = sum(br_dat), freq_br_d = n_br_d/21,
n_br_s = sum(br_soc), freq_br_s = n_br_s/21,
n_br_r = sum(br_reg), freq_br_r = n_br_r/21
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/21,
brba_sum_s <- code_freq_new_s %>%
summarise(n_br = sum(br_pos), freq_br = n_br/21,
n_ba = sum(ba_pos), freq_ba = n_ba/21,
n_br_e = sum(br_eco), freq_br_e = n_br_e/21,
n_br_d = sum(br_dat), freq_br_d = n_br_d/21,
n_br_s = sum(br_soc), freq_br_s = n_br_s/21,
n_br_r = sum(br_reg), freq_br_r = n_br_r/21,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/21,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/21,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/21,
n_ba_r = sum(ba_reg), freq_ba_r = n_ba_r/21)
brba_sum_s <- code_freq_new_s %>%
summarise(n_br = sum(br_pos), freq_br = n_br/21,
n_ba = sum(ba_pos), freq_ba = n_ba/21,
n_br_e = sum(br_eco), freq_br_e = n_br_e/21,
n_br_d = sum(br_dat), freq_br_d = n_br_d/21,
n_br_s = sum(br_soc), freq_br_s = n_br_s/21,
n_br_r = sum(br_reg), freq_br_r = n_br_r/21,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/21,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/21,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/21,
n_ba_r = sum(ba_reg), freq_ba_r = n_ba_r/21) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16, 18, 22)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s" | br_ba = "freq_ba_r", value, -value),
brba_sum_s <- code_freq_new_s %>%
summarise(n_br = sum(br_pos), freq_br = n_br/21,
n_ba = sum(ba_pos), freq_ba = n_ba/21,
n_br_e = sum(br_eco), freq_br_e = n_br_e/21,
n_br_d = sum(br_dat), freq_br_d = n_br_d/21,
n_br_s = sum(br_soc), freq_br_s = n_br_s/21,
n_br_r = sum(br_reg), freq_br_r = n_br_r/21,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/21,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/21,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/21,
n_ba_r = sum(ba_reg), freq_ba_r = n_ba_r/21) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16, 18, 22)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s" | br_ba == "freq_ba_r", value, -value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_r", "freq_br_r"), "Regulatory bridge or barrier"),
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d", "freq_br_r"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_br_r", "freq_ba_e", "freq_ba_s", "freq_ba_d", "freq_ba_r"), "alpha", "no_alpha")) %>%
group_by(code_level)
brba_sum_s <- code_freq_new_s %>%
summarise(n_br = sum(br_pos), freq_br = n_br/21,
n_ba = sum(ba_pos), freq_ba = n_ba/21,
n_br_e = sum(br_eco), freq_br_e = n_br_e/21,
n_br_d = sum(br_dat), freq_br_d = n_br_d/21,
n_br_s = sum(br_soc), freq_br_s = n_br_s/21,
n_br_r = sum(br_reg), freq_br_r = n_br_r/21,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/21,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/21,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/21,
n_ba_r = sum(ba_reg), freq_ba_r = n_ba_r/21) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16, 18, 20)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s" | br_ba == "freq_ba_r", value, -value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_r", "freq_br_r"), "Regulatory bridge or barrier"),
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d", "freq_br_r"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_br_r", "freq_ba_e", "freq_ba_s", "freq_ba_d", "freq_ba_r"), "alpha", "no_alpha")) %>%
group_by(code_level)
if_else(br_ba %in% c("freq_ba_r", "freq_br_r"), "Regulatory bridge or barrier",
brba_sum_s <- code_freq_new_s %>%
summarise(n_br = sum(br_pos), freq_br = n_br/21,
n_ba = sum(ba_pos), freq_ba = n_ba/21,
n_br_e = sum(br_eco), freq_br_e = n_br_e/21,
n_br_d = sum(br_dat), freq_br_d = n_br_d/21,
n_br_s = sum(br_soc), freq_br_s = n_br_s/21,
n_br_r = sum(br_reg), freq_br_r = n_br_r/21,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/21,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/21,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/21,
n_ba_r = sum(ba_reg), freq_ba_r = n_ba_r/21) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16, 18, 20)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s" | br_ba == "freq_ba_r", value, -value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_r", "freq_br_r"), "Regulatory bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA))))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d", "freq_br_r"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_br_r", "freq_ba_e", "freq_ba_s", "freq_ba_d", "freq_ba_r"), "alpha", "no_alpha")) %>%
group_by(code_level)
brba_sum_s <- code_freq_new_s %>%
summarise(n_br = sum(br_pos), freq_br = n_br/21,
n_ba = sum(ba_pos), freq_ba = n_ba/21,
n_br_e = sum(br_eco), freq_br_e = n_br_e/21,
n_br_d = sum(br_dat), freq_br_d = n_br_d/21,
n_br_s = sum(br_soc), freq_br_s = n_br_s/21,
n_br_r = sum(br_reg), freq_br_r = n_br_r/21,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/21,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/21,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/21,
n_ba_r = sum(ba_reg), freq_ba_r = n_ba_r/21) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16, 18, 20)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s" | br_ba == "freq_ba_r", value, -value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_r", "freq_br_r"), "Regulatory bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA))))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d", "freq_br_r"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_br_r", "freq_ba_e", "freq_ba_s", "freq_ba_d", "freq_ba_r"), "alpha", "no_alpha")) %>%
group_by(code_level)
brba_sum_s$code_level <- factor(brba_sum_s$code_level, levels = c("Social bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Regulatory bridge or barrier", "Overall bridge or barrier"))
brba_sum_s$code_brba <- factor(brba_sum_s$code_brba, levels = c("bridge", "barrier"))
ggplot(brba_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-1,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.21, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum_s$code_level <- factor(brba_sum_s$code_level, levels = c("Ecological bridge or barrier", "Data bridge or barrier", "Regulatory bridge or barrier","Social bridge or barrier", "Overall bridge or barrier"))
ggplot(brba_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-1,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.21, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
head(code_freq_new_s)
View(code_freq)
code_freq_s <- read.csv(here("data/surveys/code_freq.csv"))
head(code_freq_s)
code_freq_s <- read.csv(here("data/surveys/code_freq.csv"))
head(code_freq_s)
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
code_sum_s <- code_freq_s %>%
group_by(bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
summarise(value = n_subtotal/n_total) %>%
rename("br_ba" = code_cat) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "Data barrier" | br_ba == "Ecological barrier" | br_ba == "Social barrier" | br_ba == "Regulatory barrier", value, -value),
code_level = if_else(br_ba %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(br_ba %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(br_ba %in% c("Regulatory barrier", "Regulatory bridge"), "Regulatory bridge or barrier",
if_else(br_ba %in% c("Social barrier", "Social bridge"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("Data bridge", "Ecological bridge", "Social bridge", "Regulatory bridge"), "bridge", "barrier")) %>%
group_by(code_level) %>%
distinct()
View(code_sum_s)
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
code_sum_s <- code_freq_s %>%
group_by(bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
summarise(value = n_subtotal/n_total) %>%
rename("br_ba" = code_cat) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "Data barrier" | br_ba == "Ecological barrier" | br_ba == "Social barrier" | br_ba == "Regulation barrier", value, -value),
code_level = if_else(br_ba %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(br_ba %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(br_ba %in% c("Regulation barrier", "Regulation bridge"), "Regulatory bridge or barrier",
if_else(br_ba %in% c("Social barrier", "Social bridge"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("Data bridge", "Ecological bridge", "Social bridge", "Regulation bridge"), "bridge", "barrier")) %>%
group_by(code_level) %>%
distinct()
code_sum$code_level <- factor(code_sum$code_level, levels = c("Regulatory bridge or barrier", "Social bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier"))
code_s_sum$code_brba <- factor(code_sum_s$code_brba, levels = c("bridge", "barrier"))
code_sum_s$code_brba <- factor(code_sum_s$code_brba, levels = c("bridge", "barrier"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.4,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
code_sum_s$code_level <- factor(code_sum_s$code_level, levels = c("Data bridge or barrier", "Regulatory bridge or barrier", "Social bridge or barrier", "Ecological bridge or barrier"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.4,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
View(code_freq_s)
code_freq_s <- read.csv(here("data/surveys/code_freq.csv"))
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
code_sum_s <- code_freq_s %>%
group_by(bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
summarise(value = n_subtotal/n_total) %>%
rename("br_ba" = code_cat) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "Data barrier" | br_ba == "Ecological barrier" | br_ba == "Social barrier" | br_ba == "Regulation barrier", value, -value),
code_level = if_else(br_ba %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(br_ba %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(br_ba %in% c("Regulation barrier", "Regulation bridge"), "Regulatory bridge or barrier",
if_else(br_ba %in% c("Social barrier", "Social bridge"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("Data bridge", "Ecological bridge", "Social bridge", "Regulation bridge"), "bridge", "barrier")) %>%
group_by(code_level) %>%
distinct()
code_sum_s$code_level <- factor(code_sum_s$code_level, levels = c("Data bridge or barrier", "Regulatory bridge or barrier", "Social bridge or barrier", "Ecological bridge or barrier"))
code_sum_s$code_brba <- factor(code_sum_s$code_brba, levels = c("bridge", "barrier"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.4,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.4,0.8)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.4,0.9)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.7,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
code_sum_s$code_level <- factor(code_sum_s$code_level, levels = c("Social bridge or barrier","Data bridge or barrier", "Regulatory bridge or barrier",  "Ecological bridge or barrier"))
code_sum_s$code_brba <- factor(code_sum_s$code_brba, levels = c("bridge", "barrier"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.7,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
code_sum_s$code_level <- factor(code_sum_s$code_level, levels = c(,"Data bridge or barrier", "Regulatory bridge or barrier",  "Ecological bridge or barrier", "Social bridge or barrier"))
code_sum_s$code_level <- factor(code_sum_s$code_level, levels = c("Data bridge or barrier", "Regulatory bridge or barrier",  "Ecological bridge or barrier", "Social bridge or barrier"))
code_sum_s$code_brba <- factor(code_sum_s$code_brba, levels = c("bridge", "barrier"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.7,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
code_sum_s$code_level <- factor(code_sum_s$code_level, levels = c("Regulatory bridge or barrier",  "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
code_sum_s$code_brba <- factor(code_sum_s$code_brba, levels = c("bridge", "barrier"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.7,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
code_sum_s$code_level <- factor(code_sum_s$code_level, levels = c("Ecological bridge or barrier", "Data bridge or barrier","Regulatory bridge or barrier", "Social bridge or barrier"))
code_sum_s$code_brba <- factor(code_sum_s$code_brba, levels = c("bridge", "barrier"))
ggplot(code_sum_s, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.7,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
