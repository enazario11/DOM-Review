#plot
br_freq_s <- ggplot(code_sum_br_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
# scale_x_continuous(limits = c(0, 30),
#                    breaks = seq(0, 30, 5),
#                    name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
scale_x_reverse(limits = c(20, 0),
#breaks = seq(0, 30, 5),
name = "Percent appearance (%)")+
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#ggsave("figures/ms_figs/all_freq/br_freq_survey.png", width = 6, height = 8, units = c("in"))
#barrier freq
#reformat data
code_sum_ba_s <- code_freq_s %>%
filter(bridge_barr == "Barrier") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
ba_freq_s <- ggplot(code_sum_ba_s, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 10),
name = "Percent appearance (%)") +
scale_y_discrete(position = "right") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 16, hjust = 1),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#ggsave("figures/ms_figs/all_freq/ba_freq_survey.png", width = 6, height = 9, units = c("in"))
# Chunk 11
#| echo: false
#| message: false
#| warning: false
#| fig-width: 7
#| fig-height: 5
#| fig-align: center
code_ts <- code_vars %>%
mutate(year = str_extract_all(Doc, "\\d+\\.?\\d*"),
year = as.Date(as.character(year), format = "%Y"),
year = year(year)) %>%
select(c(Doc, year, Co.management.and.communication)) %>%
group_by(year) %>%
summarise(n_appear = sum(Co.management.and.communication),
n_year = n())
colnames(code_ts) <- c("Year", "com", "pubs")
ggplot(code_ts, aes(as.numeric(Year))) +
geom_path(aes(y = com), linewidth = 1.5, color = "dodgerblue4") +
geom_point(aes(y= com), size = 5, fill = "dodgerblue4", color = "black", shape = 21) +
geom_path(aes(y = pubs), linewidth = 1.5, color = "grey60") +
geom_point(aes(y = pubs), size = 5, fill = "grey60", color = "black", shape = 21) +
xlab("") +
ylab("Count (#)") +
theme_minimal() +
theme(axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 16, color = "black"))
# Chunk 12
#| echo: false
#| message: false
#| warning: false
#| fig-width: 5
#| fig-height: 5
#| fig-align: center
#| include: FALSE
code_rel_melt <- reshape::melt(code_rel)
code_rel_melt$variable <- gsub(".", " ", code_rel_melt$variable, fixed = TRUE)
code_rel_melt <- code_rel_melt %>%
separate(Code.System, c("key", "code1"), "> ", convert = TRUE)
code_rel_melt$key <- str_trim(code_rel_melt$key)
colnames(code_rel_melt) <- c("brba_code1", "code1", "code2", "total")
#add brba column to second code col
code_rel_melt2 <- code_rel_melt
code_rel_melt2$brba_code2 <- NA
code_rel_melt2$code2[code_rel_melt2$code2 == "Fine scale management appropriate for target species"] <- "Fine-scale management appropriate for target species"
code_rel_melt2$code2[code_rel_melt2$code2 == "Pre existing regulation and management institutions"] <- "Pre-existing regulation and management institutions"
code_rel_melt2$code2[code_rel_melt2$code2 == "Co management and communication"] <- "Co-management and communication"
for(i in 1:nrow(code_rel_melt2)){
code_temp = code_rel_melt2$code2[i]
brba_temp = code_rel_melt2 %>% filter(code1 == code_temp & code2 == code_temp)
brba_code_temp = brba_temp$brba_code1[1]
code_rel_melt2$brba_code2[i] <- brba_code_temp
}
code_rel_melt2$brba_code2[code_rel_melt2$code2 == "Target species is a prey specialist"] <- "Ecological bridge"
group_colors = c("Data Bridge" = "dodgerblue4", "Data Barrier" = "dodgerblue4", "Ecological Bridge" = "honeydew4", "Ecological Barrier" = "honeydew4", "Social Bridge" = "darkorange4", "Social Barrier" = "darkorange4")
code_rel_melt_h <- code_rel_melt2 %>%
filter(total >= 11) %>%
mutate(bor_box = ifelse(total >= 11, "TRUE", "FALSE"),
bor_box = as.factor(bor_box),
code1 = as.factor(code1),
code2 = as.factor(code2))
code_rel_melt_h$bor_box <- factor(code_rel_melt_h$bor_box, levels = c("TRUE", "FALSE"))
code_rel_melt_h <- code_rel_melt_h %>%
mutate(code1 = reorder(code1, -total, FUN = mean),
code2 = reorder(code2, total, FUN = mean))
unique_x_groups <- code_rel_melt_h %>%
distinct(code1, brba_code1) %>%
arrange(code1)
unique_y_groups <- code_rel_melt_h %>%
distinct(code2, brba_code2) %>%
arrange(code2)
x_colors <- setNames(group_colors[unique_x_groups$brba_code1], unique_x_groups$code1)
y_colors <- setNames(group_colors[unique_y_groups$brba_code2], unique_y_groups$code2)
ggplot(code_rel_melt_h, aes(x = code1, y = reorder(code2, total))) +
geom_tile(aes(fill = total, colour = bor_box)) +
scale_fill_gradient2(high = "red")+
ylab("")+
xlab("")+
labs(fill = "Number of co-occurences")+
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 14, face = "bold", color = x_colors[levels(code_rel_melt_h$code1)]),
axis.text.y = element_text(size = 14, face = "bold", color = y_colors[levels(code_rel_melt_h$code2)]),
panel.background = element_blank())+
geom_text(aes(label = total))+
scale_color_manual(values = c("black", "#00000000"))+
guides(color = "none")
#ggsave("figures/ms_figs/heat_tile.png", width = 10, height = 8, units = c("in"))
# Chunk 13
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 5
#| fig-align: center
code_vars$broad_location <- as.factor(code_vars$broad_location)
codes_LU <- code_vars[!duplicated(code_vars$Lit_unit), ]
consv <- codes_LU %>%
gather(col, consv_topic, reason1:reason3) %>%
subset(select = consv_topic)
consv_s <- consv %>%
group_by(consv_topic) %>%
filter(consv_topic != "NA") %>%
summarise(count = n()) %>%
ungroup() %>%
mutate(perc = count/sum(count)*100)
consv_bar <- ggplot(consv_s) +
geom_bar(aes(x = perc, y = reorder(consv_topic, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
scale_x_continuous(position = "top",
expand = c(0,0),
limits = c(0, 45))+
scale_y_discrete(expand = expansion(add = c(0,0))) +
theme(
# Set background color to white
panel.background = element_rect(fill = "white"),
# Set the color and the width of the grid lines for the horizontal axis
panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
# Remove tick marks by setting their length to 0
axis.ticks.length = unit(0, "mm"),
# Remove the title for both axes
axis.title = element_blank(),
# Only left line of the vertical axis is painted in black
axis.line.y.left = element_line(color = "black"),
# Remove labels from the vertical axis
axis.text.y = element_blank(),
# But customize labels for the horizontal axis
axis.text.x = element_text(family = "Arial", size = 12)) +
geom_text(aes(x = perc, y = consv_topic, label = consv_topic),
hjust = 0,
nudge_x = 0.3,
colour = "dodgerblue4",
family = "Arial",
size = 3.5)+
labs(subtitle = "Percent of sum from all articles (%)") +
theme(plot.subtitle = element_text(
family = "Arial",
size = 13)
)
consv_bar
# Chunk 14
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
#| include: false
#survey figs
#format data
freq_job_survey <- code_vars_s %>%
select(c(1, 21:54)) %>%
janitor::clean_names() %>%
pivot_longer(2:35, names_to = "sub_theme", values_to = "total") %>%
group_by(survey, sub_theme) %>%
summarise(total = sum(total),
.groups = "drop") %>%
mutate(fish_ship = ifelse(str_detect(survey, "WhaleWatch"), "Shipping", "Fishing"))
lib_job_survey <- code_freq_s %>%
mutate(id = paste(bridge_barr, code_cat, code_name, sep = "_")) %>%
select(id)
freq_job_survey$id <- NA
for(i in 1:nrow(freq_job_survey)){
curr_code = freq_job_survey$sub_theme[i]
curr_id = lib_job_survey$id[agrepl(curr_code, lib_job_survey$id, 6)]
freq_job_survey$id[i] <- curr_id
}
freq_job_survey$id[freq_job_survey$sub_theme == "stigmatization"] <- "Barrier_Social barrier_Stigmatization"
freq_job_survey$id[freq_job_survey$sub_theme == "cost"] <- "Barrier_Social barrier_Cost"
freq_job_survey <- freq_job_survey %>%
separate_wider_delim(id, delim = "_", names = c("bridge_barr", "code_cat", "code_name"))
freq_job_survey$bridge_barr <- factor(freq_job_survey$bridge_barr, levels = c("Bridge", "Barrier"))
#calculate proportions
freq_job_survey2 <- freq_job_survey %>%
group_by(fish_ship, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(fish_ship, bridge_barr, code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(code_level = if_else(code_cat %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(code_cat %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(code_cat %in% c("Social barrier", "Social bridge"), "Social bridge or barrier",
if_else(code_cat %in% c("Implementation bridge", "Implementation barrier"), "Implementation bridge or barrier", NA)))),
id = paste(fish_ship, bridge_barr, code_cat)) %>%
distinct(id, .keep_all = TRUE)
#stacked bar plots
ggplot(freq_job_survey2, aes(fill=code_level, y=value, x=fish_ship)) +
geom_bar(position="stack", stat="identity") +
scale_fill_manual(values = c("#CFE2F3", "#C5E0B4","royalblue4","#45818E")) +
facet_wrap(~bridge_barr) +
labs(fill = "") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))+
theme_ms() +
theme(legend.position = "top",
legend.justification = "left",
legend.text = element_text(size = 14, color = "black"))+
xlab("") +
ylab("Proportion of theme (%)")
#ggsave("figures/ms_figs/industry/stack_survey.png", width = 7, height = 6, units = c("in"))
#radar plots
freq_job_survey3 <- freq_job_survey %>%
group_by(fish_ship, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(fish_ship, bridge_barr, code_name) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(id = paste(fish_ship, bridge_barr, code_name)) %>%
distinct(id, .keep_all = TRUE) %>%
select(-c(id))
top_survey <- freq_job_survey3 %>%
group_by(fish_ship, bridge_barr) %>%
arrange(desc(value)) %>%
top_n(3) %>%
ungroup() %>%
select(code_name)
top_bridge <- freq_job_survey3 %>%
subset(code_name %in% top_survey$code_name) %>%
filter(bridge_barr == "Bridge") %>%
pivot_wider(names_from = code_name, values_from = value) %>%
select(-bridge_barr) %>%
mutate_all(~replace_na(., 0))
top_barrier <- freq_job_survey3 %>%
subset(code_name %in% top_survey$code_name) %>%
filter(bridge_barr == "Barrier") %>%
pivot_wider(names_from = code_name, values_from = value) %>%
select(-bridge_barr) %>%
mutate_all(~replace_na(., 0))
ggradar::ggradar(top_bridge,
values.radar = c(0, 16, 22),
background.circle.colour = "white",
axis.line.colour = "gray60",
gridline.min.colour = "gray60",
gridline.mid.colour = "gray60",
gridline.max.colour = "gray60",
group.colours = c("#F29325", "#007172"),
legend.position = "bottom",
fill = TRUE,
axis.label.size = 3)
#ggsave("figures/ms_figs/industry/radar_br_survey.png", height = 8, width = 8, units = c("in"))
ggradar::ggradar(top_barrier,
values.radar = c(0, 17, 28),
background.circle.colour = "white",
axis.line.colour = "gray60",
gridline.min.colour = "gray60",
gridline.mid.colour = "gray60",
gridline.max.colour = "gray60",
group.colours = c("#F29325", "#007172"),
legend.position = "none",
fill = TRUE,
axis.label.size = 3)
#ggsave("figures/ms_figs/industry/radar_ba_survey.png", height = 8, width = 8, units = c("in"))
#get sample sizes of survey respondants by position
n_job_survey <- code_vars_s %>%
select(c(1, 21:54)) %>%
janitor::clean_names()
table(n_job_survey$survey)
# Chunk 15
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
#| include: false
#literature figs
#format data
freq_job_lit <- code_vars %>%
select(c(1, 27:29, 33:60)) %>%
janitor::clean_names() %>%
pivot_longer(2:4, names_to = "test", values_to = "fish_ship") %>%
select(-c(test)) %>%
pivot_longer(2:29, names_to = "sub_theme", values_to = "total") %>%
group_by(fish_ship, sub_theme) %>%
summarise(total = sum(total),
.groups = "drop") %>%
filter(fish_ship == "Bycatch" | fish_ship == "Ship strikes" | fish_ship == "Overfishing" | fish_ship == "Entanglement" | fish_ship == "Avoid fisheries discharge")
lib_job_lit <- code_freq %>%
mutate(id = paste(bridge_barr, code_cat, code_name, sep = "_")) %>%
select(id)
freq_job_lit$id <- NA
for(i in 1:nrow(freq_job_lit)){
curr_code = freq_job_lit$sub_theme[i]
curr_id = lib_job_lit$id[agrepl(curr_code, lib_job_lit$id, 10)] #6 refers to the number of characters that can be diff
freq_job_lit$id[i] <- curr_id
}
freq_job_lit$id[freq_job_lit$sub_theme == "abiotic_data_availability"] <- "Bridge_Data bridge_Abiotic data availability"
freq_job_lit$id[freq_job_lit$sub_theme == "abiotic_indicators_of_target_species_presence"] <-
"Bridge_Ecological bridge_Abiotic indicators of target species presence"
freq_job_lit$id[freq_job_lit$sub_theme == "cost"] <-
"Barrier_Social barrier_Cost"
freq_job_lit$id[freq_job_lit$sub_theme == "discontinuity"] <-
"Barrier_Social barrier_Discontinuity"
freq_job_lit$id[freq_job_lit$sub_theme == "feasibility"] <-
"Bridge_Social bridge_Feasibility"
freq_job_lit$id[freq_job_lit$sub_theme == "model_abuse"] <-
"Barrier_Data barrier_Model abuse"
freq_job_lit$id[freq_job_lit$sub_theme == "resource_availability"] <-
"Bridge_Social bridge_Resource availability"
freq_job_lit <- freq_job_lit %>%
separate_wider_delim(id, delim = "_", names = c("bridge_barr", "code_cat", "code_name"))
freq_job_lit$bridge_barr <- factor(freq_job_lit$bridge_barr, levels = c("Bridge", "Barrier"))
freq_job_lit <- freq_job_lit %>%
mutate(fish_ship = ifelse(fish_ship == "Ship strikes", "Shipping", "Fishing"))
#calculate proportions
freq_job_lit2 <- freq_job_lit %>%
group_by(fish_ship, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(fish_ship, bridge_barr, code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(code_level = if_else(code_cat %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(code_cat %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(code_cat %in% c("Social barrier", "Social bridge"), "Social bridge or barrier", NA))),
id = paste(fish_ship, bridge_barr, code_cat)) %>%
distinct(id, .keep_all = TRUE)
#stacked bar plots
ggplot(freq_job_lit2, aes(fill=code_level, y=value, x=fish_ship)) +
geom_bar(position="stack", stat="identity") +
scale_fill_manual(values = c("#CFE2F3", "#C5E0B4","#45818E")) +
facet_wrap(~bridge_barr) +
labs(fill = "") +
guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme_ms() +
theme(legend.position = "top",
legend.justification = "left",
legend.text = element_text(size = 14, color = "black")) +
xlab("") +
ylab("Proportion of theme (%)")
#ggsave("figures/ms_figs/industry/stack_lit.png", width = 7, height = 6, units = c("in"))
#radar plots
freq_job_lit3 <- freq_job_lit %>%
group_by(fish_ship, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(fish_ship, bridge_barr, code_name) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(id = paste(fish_ship, bridge_barr, code_name)) %>%
distinct(id, .keep_all = TRUE) %>%
select(-c(id))
top_lit <- freq_job_lit3 %>%
group_by(fish_ship, bridge_barr) %>%
arrange(desc(value)) %>%
top_n(3) %>%
ungroup() %>%
select(code_name)
top_bridge <- freq_job_lit3 %>%
subset(code_name %in% top_lit$code_name) %>%
filter(bridge_barr == "Bridge") %>%
pivot_wider(names_from = code_name, values_from = value) %>%
select(-bridge_barr) %>%
mutate_all(~replace_na(., 0))
top_barrier <- freq_job_lit3 %>%
subset(code_name %in% top_lit$code_name) %>%
filter(bridge_barr == "Barrier") %>%
pivot_wider(names_from = code_name, values_from = value) %>%
select(-bridge_barr) %>%
mutate_all(~replace_na(., 0))
ggradar::ggradar(top_bridge,
values.radar = c(0, 8, 16),
background.circle.colour = "white",
axis.line.colour = "gray60",
gridline.min.colour = "gray60",
gridline.mid.colour = "gray60",
gridline.max.colour = "gray60",
group.colours = c("#F29325", "#007172"),
legend.position = "bottom",
fill = TRUE,
axis.label.size = 3)
#ggsave("figures/ms_figs/industry/radar_br_lit.png", height = 8, width = 8, units = c("in"))
ggradar::ggradar(top_barrier,
values.radar = c(0, 17, 37),
background.circle.colour = "white",
axis.line.colour = "gray60",
gridline.min.colour = "gray60",
gridline.mid.colour = "gray60",
gridline.max.colour = "gray60",
group.colours = c("#F29325", "#007172"),
legend.position = "none",
fill = TRUE,
axis.label.size = 3)
#ggsave("figures/ms_figs/industry/radar_ba_lit.png", height = 8, width = 8, units = c("in"))
#get sample sizes of survey respondants by position
n_job_lit <- code_vars %>%
select(c(1, 27:29, 33:60)) %>%
janitor::clean_names()  %>%
pivot_longer(2:4, names_to = "test", values_to = "fish_ship") %>%
select(-c(test)) %>%
filter(fish_ship == "Bycatch" | fish_ship == "Ship strikes" | fish_ship == "Overfishing" | fish_ship == "Entanglement" | fish_ship == "Avoid fisheries discharge") %>%
mutate(fish_ship = ifelse(fish_ship == "Ship strikes", "Shipping", "Fishing"))
table(n_job_lit$fish_ship)
# Chunk 16
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
#| include: false
#survey figs
#format data
freq_pos_survey <- code_vars_s %>%
select(c(6:10, 21:54)) %>%
janitor::clean_names() %>%
pivot_longer(1:5, names_to = "test", values_to = "position") %>%
select(-c(test)) %>%
pivot_longer(1:34, names_to = "sub_theme", values_to = "total") %>%
group_by(position, sub_theme) %>%
summarise(total = sum(total),
.groups = "drop") %>%
drop_na(position)
lib_job_survey <- code_freq_s %>%
mutate(id = paste(bridge_barr, code_cat, code_name, sep = "_")) %>%
select(id)
freq_pos_survey$id <- NA
for(i in 1:nrow(freq_pos_survey)){
curr_code = freq_pos_survey$sub_theme[i]
curr_id = lib_job_survey$id[agrepl(curr_code, lib_job_survey$id, 6)]
freq_pos_survey$id[i] <- curr_id
}
freq_pos_survey$id[freq_pos_survey$sub_theme == "stigmatization"] <- "Barrier_Social barrier_Stigmatization"
freq_pos_survey$id[freq_pos_survey$sub_theme == "cost"] <- "Barrier_Social barrier_Cost"
freq_pos_survey <- freq_pos_survey %>%
separate_wider_delim(id, delim = "_", names = c("bridge_barr", "code_cat", "code_name"))
freq_pos_survey$bridge_barr <- factor(freq_pos_survey$bridge_barr, levels = c("Bridge", "Barrier"))
#calculate proportions
freq_pos_survey2 <- freq_pos_survey %>%
group_by(position, bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(position, bridge_barr, code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
reframe(value = (n_subtotal/n_total)*100) %>%
ungroup() %>%
mutate(code_level = if_else(code_cat %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(code_cat %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(code_cat %in% c("Social barrier", "Social bridge"), "Social bridge or barrier",
if_else(code_cat %in% c("Implementation bridge", "Implementation barrier"), "Implementation bridge or barrier", NA)))),
id = paste(position, bridge_barr, code_cat)) %>%
distinct(id, .keep_all = TRUE)
#stacked bar plots
ggplot(freq_pos_survey2, aes(fill=code_level, y=value, x=position)) +
geom_bar(position="stack", stat="identity") +
scale_fill_manual(values = c("#CFE2F3", "#C5E0B4","royalblue4","#45818E")) +
facet_wrap(~bridge_barr) +
labs(fill = "") +
theme_ms() +
theme(legend.position = "top",
legend.justification.top = "left",
legend.title = element_text(size = 16, color = "black"),
legend.text = element_text(size = 14, color = "black"))+
guides(fill=guide_legend(nrow=2,byrow=TRUE))+
xlab("") +
ylab("Proportion of theme (%)")+
theme(axis.text.x = element_text(size = 14, color = "black", angle = 60, hjust = 1))
#ggsave("figures/ms_figs/position/stack_survey.png", width = 10, height = 8, units = c("in"))
#get sample sizes of survey respondants by position
n_pos_survey <- code_vars_s %>%
select(c(6:10, 21:54)) %>%
janitor::clean_names() %>%
pivot_longer(1:5, names_to = "test", values_to = "position") %>%
select(-c(test)) %>%
drop_na(position)
table(n_pos_survey$position)
View(all_freq_survey)
