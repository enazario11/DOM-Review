axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 12, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.text = element_text(face = "bold", size = 14),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.text = element_text(face = "bold", size = 14, hjust = -1),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.text = element_text(face = "bold", size = 14, hjust = 0),
strip.placement = "outside",
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.text = element_text(face = "bold", size = 14, hjust = -1),
strip.placement = "outside",
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.text = element_text(face = "bold", size = 14, hjust = 0),
strip.placement = "outside",
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.switch.pad.grid = unit(1, "cm"),
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.switch.pad.grid = unit(1, "cm"),
strip.text = element_text(face = "bold", size = 14, hjust = -1),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.switch.pad.grid = unit(1, "cm"),
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = -1),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = -3),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = -4),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = -4),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ggsave("figures/ms_figs/all_freq/br_freq.png", width = 7, height = 10, units = c("in"))
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 20),
breaks = seq(0, 20, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = -8),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ggsave("figures/ms_figs/all_freq/br_freq.png", width = 7, height = 8, units = c("in"))
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 4, color = "goldenrod") +
scale_x_continuous(limits = c(0, 15),
breaks = seq(0, 15, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = -8),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ggsave("figures/ms_figs/all_freq/br_freq.png", width = 7, height = 8, units = c("in"))
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
scale_x_continuous(limits = c(0, 15),
breaks = seq(0, 15, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = -8),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
code_sum <- code_freq %>%
group_by(bridge_barr) %>%
mutate(n_total = sum(total)) %>%
ungroup() %>%
group_by(code_cat) %>%
mutate(n_subtotal = sum(total)) %>%
summarise(value = n_subtotal/n_total) %>%
rename("br_ba" = code_cat) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "Data barrier" | br_ba == "Ecological barrier" | br_ba == "Social barrier", value, -value),
code_level = if_else(br_ba %in% c("Ecological barrier", "Ecological bridge"), "Ecological bridge or barrier",
if_else(br_ba %in% c("Data barrier", "Data bridge"), "Data bridge or barrier",
if_else(br_ba %in% c("Social barrier", "Social bridge"), "Social bridge or barrier", NA))),
code_brba = if_else(br_ba %in% c("Data bridge", "Ecological bridge", "Social bridge"), "bridge", "barrier")) %>%
group_by(code_level) %>%
distinct()
code_sum$code_level <- factor(code_sum$code_level, levels = c("Social bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier"))
code_sum$code_brba <- factor(code_sum$code_brba, levels = c("bridge", "barrier"))
ggplot(code_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.4,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggsave("figures/ms_figs/all_freq/all_freq.png", width = 5, height = 5, units = ("in"))
#plot
ggplot(code_sum_sub, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
scale_x_continuous(limits = c(0, 15),
breaks = seq(0, 15, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
#reformat data
code_sum_ba <- code_freq %>%
filter(bridge_barr == "Barrier") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 15),
breaks = seq(0, 15, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 50),
breaks = seq(0, 15, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 50),
breaks = seq(0, 50, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 35),
breaks = seq(0, 35, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ggplot(code_sum_br, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
scale_x_continuous(limits = c(0, 35),
breaks = seq(0, 35, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#| echo: false
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
#reformat data
code_sum_br <- code_freq %>%
filter(bridge_barr == "Bridge") %>%
mutate(n_total = sum(total)) %>%
group_by(code_cat, code_name) %>%
summarise(value = total/n_total) %>% #percentages represent total number of bridge or barriers codes that code represents
mutate(percent = scales::percent(value, accuracy = 1),
code_name = factor(code_name)) %>%
ungroup() %>%
group_by(code_cat) %>%
arrange(code_name, desc(percent))
#plot
ggplot(code_sum_br, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
scale_x_continuous(limits = c(0, 35),
breaks = seq(0, 35, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ggsave("figures/ms_figs/all_freq/br_freq.png", width = 7, height = 8, units = c("in"))
#plot
ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 35),
breaks = seq(0, 35, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ggsave("figures/ms_figs/all_freq/ba_freq.png", width = 7, height = 8, units = c("in"))
ggsave("figures/ms_figs/all_freq/ba_freq.png", width = 8, height = 8, units = c("in"))
ggsave("figures/ms_figs/all_freq/all_freq.png", width = 8, height = 5, units = ("in"))
ggplot(code_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.65),
color = "black",
size = 5) +
ylim(-0.4,0.7)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("goldenrod", "lightskyblue3"), labels = c("Bridge frequency", "Barrier frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 20, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.17, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggsave("figures/ms_figs/all_freq/all_freq.png", width = 8, height = 5, units = ("in"))
#plot
br_freq <- ggplot(code_sum_br, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
scale_x_continuous(limits = c(0, 35),
breaks = seq(0, 35, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ba_freq <- ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 35),
breaks = seq(0, 35, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
library(patchwork)
br_freq|ba_freq
#plot
ba_freq <- ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 30),
breaks = seq(0, 30, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 30),
breaks = seq(0, 30, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
br_freq <- ggplot(code_sum_br, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "goldenrod") +
scale_x_continuous(limits = c(0, 30),
breaks = seq(0, 30, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
#plot
ba_freq <- ggplot(code_sum_ba, aes(x = value*100, y = reorder(code_name, value))) +
geom_point(size = 5, color = "lightskyblue3") +
scale_x_continuous(limits = c(0, 30),
breaks = seq(0, 30, 5),
name = "Percent appearance (%)") +
theme_minimal() +
facet_wrap("code_cat", ncol = 1, scales = "free_y") +
theme(strip.placement = "outside",
strip.text = element_text(face = "bold", size = 14, hjust = 0),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 14, color = "black")) +
ylab("")
br_freq|ba_freq
ggsave("figures/ms_figures/all_freq/br_ba_freq.png", width = 8, height = 8, units = c("in"))
ggsave("figures/ms_figs/all_freq/br_ba_freq.png", width = 8, height = 8, units = c("in"))
