size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod", "goldenrod", "cadetblue4", "goldenrod", "cadetblue4", "goldenrod", "cadetblue4", "goldenrod", "cadetblue4"), breaks = top_cats, labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Total bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s"),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), breaks = top_cats, labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Total bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s"),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba,
alpha = alpha_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba,
alpha = alpha_brba)) +
geom_col(width = 0.7, alpha = 0.5) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
ggplot(brba_sum, aes(x = fct_reorder(code_level, percent),
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Total bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s", ordered = TRUE),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
?fct_relevel
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Total bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s"),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$br_ba, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Total bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s"),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s"),
br_ba = fct_rev(br_ba)) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha"),
br_ba = fct_relevel(br_ba, "freq_br", "freq_ba", "freq_br_e", "freq_ba_e", "freq_br_d", "freq_ba_d", "freq_br_s", "freq_ba_s")) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum <- code_freq_new %>%
summarise(n_br = sum(br_pos), freq_br = n_br/109,
n_ba = sum(ba_pos), freq_ba = n_ba/109,
n_br_e = sum(br_eco), freq_br_e = n_br_e/109,
n_br_d = sum(br_dat), freq_br_d = n_br_d/109,
n_br_s = sum(br_soc), freq_br_s = n_br_s/109,
n_ba_e = sum(ba_eco), freq_ba_e = n_ba_e/109,
n_ba_d = sum(ba_dat), freq_ba_d = n_ba_d/109,
n_ba_s = sum(ba_soc), freq_ba_s = n_ba_s/109) %>%
gather(br_ba, value, c(2,4,6, 8, 10, 12, 14, 16)) %>%
subset(select = c(br_ba, value)) %>%
mutate(percent_label = scales::percent(value, accuracy = 1),
percent = if_else(br_ba == "freq_ba" | br_ba == "freq_ba_e" | br_ba == "freq_ba_d" | br_ba == "freq_ba_s", -value, value),
code_level = if_else(br_ba %in% c("freq_ba", "freq_br"), "Overall bridge or barrier",
if_else(br_ba %in% c("freq_ba_e", "freq_br_e"), "Ecological bridge or barrier",
if_else(br_ba %in% c("freq_ba_d", "freq_br_d"), "Data bridge or barrier",
if_else(br_ba %in% c("freq_ba_s", "freq_br_s"), "Social bridge or barrier", NA)))),
code_brba = if_else(br_ba %in% c("freq_br", "freq_br_e", "freq_br_s", "freq_br_d"), "bridge", "barrier"),
alpha_brba = if_else(br_ba %in% c("freq_br_e", "freq_br_s", "freq_br_d", "freq_ba_e", "freq_ba_s", "freq_ba_d"), "alpha", "no_alpha")) %>%
group_by(code_level)
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Overall bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Ecological bridge or barrier", "Data bridge or barrier", "Social bridge or barrier", "Overall bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Ecological bridge or barrier", "Social bridge or barrier", "Data bridge or barrier", "Overall bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
brba_sum$code_level <- factor(brba_sum$code_level, levels = c("Social bridge or barrier", "Ecological bridge or barrier", "Data bridge or barrier", "Overall bridge or barrier"))
ggplot(brba_sum, aes(x = code_level,
y = percent,
fill = code_brba)) +
geom_col(width = 0.7) +
geom_text(aes(label = percent_label),
position = position_stack(vjust = 0.5),
color = "black",
size = 5) +
ylim(-0.58,1)+
coord_flip() +
scale_x_discrete() +
scale_fill_manual(values = c("cadetblue4", "goldenrod"), labels = c("Barrier frequency", "Bridge frequency")) +
theme_minimal() +
theme(axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x =element_blank(),
axis.text.y = element_text(size = 16, color = "black"),
panel.grid = element_blank(),
legend.position = c(-0.1, 0.99),
legend.text = element_text(size = 16, color = "black"),
strip.text.y.right = element_text(angle = 0, size = 16)) +
geom_hline(yintercept = 0.0, linewidth = 1) +
labs(fill = "")+
guides(fill = guide_legend(nrow = 1))
