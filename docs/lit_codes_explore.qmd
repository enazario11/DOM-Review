---
title: "literature coding explore"
date: "`r Sys.Date()`"
format:
 html: 
  self-contained: true
editor: visual
toc: TRUE
toc-title: "On this page"
theme: yeti
fontcolor: "#134f5c"
---

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(tidyquant)
library(here)

codes_vars <- read.csv(here("data/code_w_vars.csv"))
code_freq <- read.csv(here("data/code_freq2.csv"))
keywords <- read.csv(here("data/keywords.csv"))
occur_all <- read.csv(here("data/overlap_all.csv"))
occur_br <- read.csv(here("data/overlap_bridge.csv"))
occur_ba <- read.csv(here("data/overlap_barrier.csv"))
```

## Selecting the literature that was included in this systematic review

In June 2022 a systematic search was completed using Web of Science to identify articles that mentioned factors that either contributed to "successful" implementation of dynamic ocean management (DOM), hereafter referred to as a "bridge". Literature that discussed factors that would need to be addressed or considered prior to effective implementation of dynamic management approaches or tools were also included, hereafter referred to as a "barrier". In this systematic review, we coded bridges and barriers that were related to DOM voluntary programs or enforced regulations, as well as those that were related to tools (e.g., species spatial modeling tools such as EcoCast) that support dynamic management approaches.

During the initial search, the following table of primary and secondary terms were used:

| Primary term               | Secondary term |
|----------------------------|----------------|
| Dynamic ocean management   | Success        |
| Dynamic spatial management | Efficiency     |
| Adaptive management        | Obstacles      |
| Dynamic closures           | Limitations    |
| Bycatch reduction          |                |
| Habitat preference         |                |

A search was completed in Web of Science for each combination of primary and secondary terms. Works from the primary (i.e., peer reviewed journals) and grey (e.g., theses, book chapters) were included, and this initial search resulted in 1,351 articles. The titles and abstracts for each of these documents were scanned for relevance, and the inclusion of the terms 'dynamic' or 'adaptive' management were confirmed. From this cut, a remaining 127 articles were saved. An additional search through the NOAA Institutional Repository and Federal Register was also completed. Here, documents such as policy reports and planning documents were selected. This search resulted in 795 documents. The titles and abstracts for each of these documents were scanned for relevance, and ultimately, 10 articles were saved for a full read through to determine final inclusion. Inclusion and exclusion criteria for both queries are described here:

| Inclusion                                                                                                                                                                                                  | Exclusion                                                                                                                                                                                                    |
|------------------------------------|:-----------------------------------|
| All cases where adaptive or near-real time forms of management or tools that support this form of management were discussed, even if the specific term 'Dynamic Ocean Management' was not explicitly used. | The term 'DOM' was mentioned, or even recommended, but there was no discussion as to why (e.g. SDM studies that suggest DOM applications as a next step for their model)                                     |
| All cases where near real-time SDM tools or fleet-wide communication to avoid negative species interactions.                                                                                               | Articles that involved changes or updates to environmental data stores or remote sensing tools used for developing SDM tools to support DOM, but DOM was not specifically applied, recommended, or reviewed. |

The final list of included works consisted of 137 documents. Each of these were fully read by two reviewers and went through a final pass for determining inclusion. Additional snowball sampling was performed to identify and include articles that were referenced in this list. The abstracts of these referenced articles were read and their inclusion was determined. Lastly, the search ended in August 2023 and articles or documents published after this date were not included in this review. The final list of works analyzed for the review included 110 articles (i.e., primary literature, student theses, policy reports, textbook chapters).

## Coding the bridges and barriers as identified in the literature

Two reviewers went through each of the 110 articles to identify pieces of text that were related to the "successful" implementation of DOM or its recommendation, as well as the barriers or obstacles that hindered the efficacy of this approach or must be considered prior to it's broader application. Through this effort, 17 "bridges" and 9 "barriers" themes were coded. For both the bridges and barriers code categories, three larger groups were established: species, social, and data factors. A draft of the full list of codes/themes are depicted here. Please note that this was a draft of codes, and thus a few themes may be missing or the exact language may be revised over time.

::: panel-tabset
### Bridges

![](images/sunburst_success.png){fig-align="center" width="100%"}

### Barriers

![](images/sunburst_limits.png){width="100%"}
:::

## Visualizing the bridges and barriers themes from the literature

Below is a first attempt at how to visualize some of the data collected from this review. This first section represents general information about the articles selected for this review (e.g., study location, fisheries or shipping channels involved, species for which the tool or management program was established for).

### Study information

::: panel-tabset
#### Study regions

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-width: 7
#| fig-height: 7

codes_vars$broad_location <- as.factor(codes_vars$broad_location)
codes_LU <- codes_vars[!duplicated(codes_vars$Lit_unit), ]
reg_s <- codes_LU %>%
  group_by(broad_location) %>%
  filter(broad_location != "NA" & broad_location != "Europe and United States") %>%
  summarise(count = n()) %>%
  ungroup() %>%
  mutate(perc = count/sum(count)*100) 


reg_bar <- ggplot(reg_s) +
  geom_bar(aes(x = perc, y = reorder(broad_location, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
  scale_x_continuous(position = "top", 
                     expand = c(0,0), 
                     limits = c(0, 48))+
  scale_y_discrete(expand = expansion(add = c(0.5,0.5))) + 
  theme(
    # Set background color to white
    panel.background = element_rect(fill = "white"),
    # Set the color and the width of the grid lines for the horizontal axis
    panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
    # Remove tick marks by setting their length to 0
    axis.ticks.length = unit(0, "mm"),
    # Remove the title for both axes
    axis.title = element_blank(),
    # Only left line of the vertical axis is painted in black
    axis.line.y.left = element_line(color = "black"),
    # Remove labels from the vertical axis
    axis.text.y = element_blank(),
    # But customize labels for the horizontal axis
    axis.text.x = element_text(family = "Econ Sans Cnd", size = 12)) + 
  geom_text(aes(x = perc, y = broad_location, label = broad_location),
    hjust = 0,
    nudge_x = 0.3,
    colour = "dodgerblue4",
    family = "Econ Sans Cnd",
    size = 3.5)+
  labs(subtitle = "Percent of sum from all articles (%)") + 
  theme(plot.subtitle = element_text(
      family = "Econ Sans Cnd",
      size = 13)
  )

reg_bar
```

#### Study fisheries and shipping channels

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-height: 10
#| fig-width: 10
fsh_shp <- codes_LU %>%
  gather(col, fsh_shp, fishery_or_channel1:fishery_or_channel4) %>%
  subset(select = fsh_shp)


fsh_shp_s <- fsh_shp %>%
  group_by(fsh_shp) %>%
  filter(fsh_shp != "NA") %>%
  summarise(count = n()) %>%
  ungroup() %>%
  mutate(perc = count/sum(count)*100) 


fsh_shp_bar <- ggplot(fsh_shp_s) +
  geom_bar(aes(x = perc, y = reorder(fsh_shp, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
  scale_x_continuous(position = "top", 
                     expand = c(0,0), 
                     limits = c(0, 14))+
  scale_y_discrete(expand = expansion(add = c(0.5,0.5))) + 
  theme(
    # Set background color to white
    panel.background = element_rect(fill = "white"),
    # Set the color and the width of the grid lines for the horizontal axis
    panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
    # Remove tick marks by setting their length to 0
    axis.ticks.length = unit(0, "mm"),
    # Remove the title for both axes
    axis.title = element_blank(),
    # Only left line of the vertical axis is painted in black
    axis.line.y.left = element_line(color = "black"),
    # Remove labels from the vertical axis
    axis.text.y = element_blank(),
    # But customize labels for the horizontal axis
    axis.text.x = element_text(family = "Econ Sans Cnd", size = 15)) + 
  geom_text(aes(x = perc, y = fsh_shp, label = fsh_shp),
    hjust = 0,
    nudge_x = 0.3,
    colour = "dodgerblue4",
    family = "Econ Sans Cnd",
    size = 5)+
  labs(subtitle = "Percent of sum from all articles (%)") + 
  theme(plot.subtitle = element_text(
      family = "Econ Sans Cnd",
      size = 16)
  )

fsh_shp_bar
```

#### Study species

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-width: 7
#| fig-height: 7

species <- codes_LU %>%
  gather(col, taxa, focal_taxa1:focal_taxa3) %>%
  subset(select = taxa)

spp_s <- species %>%
  group_by(taxa) %>%
  filter(taxa != "NA" & taxa != "Marine mammals") %>%
  summarise(count = n()) %>%
  ungroup() %>%
  mutate(perc = count/sum(count)*100) 

taxa_bar <- ggplot(spp_s) +
  geom_bar(aes(x = perc, y = reorder(taxa, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
  scale_x_continuous(position = "top", 
                     expand = c(0,0), 
                     limits = c(0, 23))+
  scale_y_discrete(expand = expansion(add = c(0.5,0.5))) + 
  theme(
    # Set background color to white
    panel.background = element_rect(fill = "white"),
    # Set the color and the width of the grid lines for the horizontal axis
    panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
    # Remove tick marks by setting their length to 0
    axis.ticks.length = unit(0, "mm"),
    # Remove the title for both axes
    axis.title = element_blank(),
    # Only left line of the vertical axis is painted in black
    axis.line.y.left = element_line(color = "black"),
    # Remove labels from the vertical axis
    axis.text.y = element_blank(),
    # But customize labels for the horizontal axis
    axis.text.x = element_text(family = "Econ Sans Cnd", size = 12)) + 
  geom_text(aes(x = perc, y = taxa, label = taxa),
    hjust = 0,
    nudge_x = 0.3,
    colour = "dodgerblue4",
    family = "Econ Sans Cnd",
    size = 3.5)+
  labs(subtitle = "Percent of sum from all articles (%)") + 
  theme(plot.subtitle = element_text(
      family = "Econ Sans Cnd",
      size = 13)
  )

taxa_bar
```

#### Conservation problem being addressed

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-width: 7
#| fig-height: 7

consv <- codes_LU %>%
  gather(col, consv_topic, reason1:reason3) %>%
  subset(select = consv_topic)

consv_s <- consv %>%
  group_by(consv_topic) %>%
  filter(consv_topic != "NA") %>%
  summarise(count = n()) %>%
  ungroup() %>%
  mutate(perc = count/sum(count)*100) 

consv_bar <- ggplot(consv_s) +
  geom_bar(aes(x = perc, y = reorder(consv_topic, perc)), fill = "dodgerblue4", width = 0.6, stat = "identity")+
  scale_x_continuous(position = "top", 
                     expand = c(0,0), 
                     limits = c(0, 18))+
  scale_y_discrete(expand = expansion(add = c(0,0))) + 
  theme(
    # Set background color to white
    panel.background = element_rect(fill = "white"),
    # Set the color and the width of the grid lines for the horizontal axis
    panel.grid.major.x = element_line(color = "#A8BAC4", size = 0.3),
    # Remove tick marks by setting their length to 0
    axis.ticks.length = unit(0, "mm"),
    # Remove the title for both axes
    axis.title = element_blank(),
    # Only left line of the vertical axis is painted in black
    axis.line.y.left = element_line(color = "black"),
    # Remove labels from the vertical axis
    axis.text.y = element_blank(),
    # But customize labels for the horizontal axis
    axis.text.x = element_text(family = "Econ Sans Cnd", size = 12)) + 
  geom_text(aes(x = perc, y = consv_topic, label = consv_topic),
    hjust = 0,
    nudge_x = 0.3,
    colour = "dodgerblue4",
    family = "Econ Sans Cnd",
    size = 3.5)+
  labs(subtitle = "Percent of sum from all articles (%)") + 
  theme(plot.subtitle = element_text(
      family = "Econ Sans Cnd",
      size = 13)
  )

consv_bar
```
:::

### Code counts/frequencies

### Codes vs. study information

### Code co-occurrence themes

::: panel-tabset
#### All codes

#### Bridges codes

#### Barriers codes
:::

### Keywords and literature type

::: panel-tabset
#### Keywords

#### Literature type
:::
